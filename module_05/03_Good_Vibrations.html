
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Good Vibrations &#8212; Computational Mechanics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Computational Mechanics Boundary Values - Project 05" href="../projects/05-BVPs_project.html" />
    <link rel="prev" title="Keep it Steady" href="02_Keep_it_steady.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/comp-mech-logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Computational Mechanics
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus - Computational Mechanics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../how-to/update-github.html">
   Working in your  Fork on GitHub.com
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_01/README.html">
   Computational Mechanics 01 - Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/01_Interacting_with_Python.html">
     01 - Interacting with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/02_Working_with_Python.html">
     02 - Working with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/03_Numerical_error.html">
     03 - Numerical Error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/01_Getting-started-project.html">
     Computational Mechanics Project #01 - Heat Transfer in Forensic Science
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_02/README.html">
   Computational Mechanics 02 - Analyze Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/01_Cheers_Stats_Beers.html">
     01 - Cheers!  Stats with Beers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/02_Seeing_Stats.html">
     02 - Seeing stats in a new light
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/03_Linear_Regression_with_Real_Data.html">
     03 - Linear regression with real data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/04_Stats_and_Montecarlo.html">
     04 - Statistics and Monte-Carlo Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/02_Analyze-data_project.html">
     Project #02 - NYSE random walk predictor
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_03/README.html">
   Computational Mechanics 03- Initial Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/01_Catch_Motion.html">
     Catch things in motion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/02_Step_Future.html">
     Step to the future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/03_Get_Oscillations.html">
     Get with the oscillations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/04_Getting_to_the_root.html">
     Roots of Nonlinear functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/03_IVP-project.html">
     Initial Value Problems - Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_04/README.html">
   Computational Mechanics 4 - Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/01_Linear-Algebra.html">
     Linear Algebra Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/02_Gauss_elimination.html">
     Gauss Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/03_Linear-regression-algebra.html">
     Linear Regression Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/04_Linear_Algebra-project.html">
     CompMech04-Linear Algebra Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Computational Mechanics 5 - Boundary Value Problems
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_Revisiting_derivatives.html">
     Revisiting Derivatives
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_Keep_it_steady.html">
     Keep it Steady
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Good Vibrations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/05-BVPs_project.html">
     Computational Mechanics Boundary Values - Project 05
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../how-to/README.html">
   Quick How-to documents
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/update-github.html">
     Working in your  Fork on GitHub.com
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/polyfit.html">
     Creating a quadratic fit on random data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/for-loops.html">
     How to use a
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loop?
     <em>
      in Python
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/extra-FEA_material.html">
     Extra Material: Direct stiffness method for Finite Element analysis (FEA)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/module_05/03_Good_Vibrations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/module_05/03_Good_Vibrations.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cooperrc/computational-mechanics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cooperrc/computational-mechanics/issues/new?title=Issue%20on%20page%20%2Fmodule_05/03_Good_Vibrations.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cooperrc/computational-mechanics/master?urlpath=tree/module_05/03_Good_Vibrations.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://compmech.uconn.edu/hub/user-redirect/git-pull?repo=https://github.com/cooperrc/computational-mechanics&urlpath=tree/computational-mechanics/module_05/03_Good_Vibrations.md&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Good Vibrations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boundary-value-problems-with-multiple-solutions-eigenvalues">
     Boundary value problems with multiple solutions (Eigenvalues)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivatives-in-engineering-equations">
     Derivatives in Engineering equations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-harmonic-motion-with-two-degrees-of-freedom">
     Simple harmonic motion with two degrees of freedom
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#eigenvalues-natural-frequencies">
       Eigenvalues == Natural Frequencies
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numpy-s-eig-function">
       Numpy’s
       <code class="docutils literal notranslate">
        <span class="pre">
         eig
        </span>
       </code>
       function
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise">
       Exercise
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-algebra-mathbf-ax-b-vs-mathbf-ax-lambda-mathbf-x">
       Linear Algebra:
       <span class="math notranslate nohighlight">
        \(\mathbf{Ax=b}\)
       </span>
       vs
       <span class="math notranslate nohighlight">
        \(\mathbf{Ax}=\lambda\mathbf{x}\)
       </span>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#integrating-your-new-function">
       Integrating your new function
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discussion">
       Discussion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Exercise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#back-to-your-guitar-string">
     Back to your Guitar String
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Discussion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predicting-your-guitar-string-motion">
       Predicting your guitar string motion
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#note-eig-returns-complex-unsorted-eigenvalues">
         Note:
         <code class="docutils literal notranslate">
          <span class="pre">
           eig
          </span>
         </code>
         returns complex, unsorted eigenvalues
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Exercise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-your-solution-for-y-x-t">
     Creating your solution for y(x,t)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#integrate-over-time">
       Integrate over time
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Discussion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solution-1-y-x-0-0-1-sin-pi-x-l">
       1. Solution 1:
       <span class="math notranslate nohighlight">
        \(y(x,0) = 0.1\sin(\pi x/L)\)
       </span>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#fancy-3d-plot-to-see-the-whole-y-x-t-stretched-out-over-the-time-and-space-axes">
         Fancy 3D plot to see the whole y(x,t) stretched out over the time and space axes
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solution-2-y-x-0-0-1x-0-2h-x-l-2-x-l-2">
       2. Solution 2:
       <span class="math notranslate nohighlight">
        \(y(x,0) = 0.1x-0.2H(x-L/2)(x-L/2)\)
       </span>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Exercise
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#increase-length-of-simulation">
       Increase length of simulation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualizing-the-motion">
       Visualizing the motion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#animation-of-string-from">
       Animation of String from
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#t-0-91-4-ms-frame-every-0-24-ms">
       t=0-91.4 ms frame every 0.24 ms
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#listen-to-your-data">
     Listen to your data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Exercise
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#listen-to-your-simulated-guitar">
       Listen to your simulated Guitar
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Discussion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-you-ve-learned">
     What You’ve Learned
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="good-vibrations">
<h1>Good Vibrations<a class="headerlink" href="#good-vibrations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="boundary-value-problems-with-multiple-solutions-eigenvalues">
<h2>Boundary value problems with multiple solutions (Eigenvalues)<a class="headerlink" href="#boundary-value-problems-with-multiple-solutions-eigenvalues" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="derivatives-in-engineering-equations">
<h2>Derivatives in Engineering equations<a class="headerlink" href="#derivatives-in-engineering-equations" title="Permalink to this headline">¶</a></h2>
<p>In this final module, you will use all of the tools from previous modules to solve the <a class="reference external" href="http://hyperphysics.phy-astr.gsu.edu/hbase/Waves/waveq.html">wave equation</a> for a vibrating guitar string. You will also learn a couple new things including <a class="reference external" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvalues</a> [1] and new <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html#classes">data displays</a>.</p>
<p>Consider a vibrating A-note guitar string that has a density, <span class="math notranslate nohighlight">\(\mu=4.5~g/m\)</span>, and tension, <span class="math notranslate nohighlight">\(T=88~N\)</span>. At each point along the string, the force balance in the y-direction leads to acceleration of that part of the string. For a small section of string along <span class="math notranslate nohighlight">\(dx\)</span>, shown below, there is a small mass, <span class="math notranslate nohighlight">\(dm=\mu dx.\)</span> Using Newton’s second law, you find that the acceleration at each point on the string is proportional to curvature of the string, <span class="math notranslate nohighlight">\(\frac{\partial^2 y}{\partial x^2},\)</span> as seen in the free body diagram below.</p>
<p><strong>Guitar string equation:</strong> <span class="math notranslate nohighlight">\(\mu\frac{\partial^2 y}{\partial t^2}=T\frac{\partial ^2 y}{\partial x^2}\)</span></p>
<p><img alt="Free body diagram and resulting equation of motion for a string" src="../_images/wave_string.png" /></p>
<p>The <strong>Guitar string equation</strong> is a specific form of a more general equation, the <a class="reference external" href="https://www.animations.physics.unsw.edu.au/jw/wave_equation_speed.htm">wave equation</a>. The wave equation, is a partial differential equation that describes the relation between shape and motion. The term, <span class="math notranslate nohighlight">\(\frac{d^2 y}{dt^2},\)</span> describes acceleration and the term, <span class="math notranslate nohighlight">\(\frac{d^2 y}{dx^2},\)</span> describes the curvature of the string. The bigger the curvature, the more the string accelerates.</p>
<p><strong>Before you jump into solutions for the wave equation, let’s consider a simpler discrete problem:</strong></p>
</div>
<div class="section" id="simple-harmonic-motion-with-two-degrees-of-freedom">
<h2>Simple harmonic motion with two degrees of freedom<a class="headerlink" href="#simple-harmonic-motion-with-two-degrees-of-freedom" title="Permalink to this headline">¶</a></h2>
<p>The solution for a modal analysis is accomplished by solving for eigenvalues of
the mass and stiffness matrices, <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>, respectively <a class="reference external" href="https://www.scribd.com/document/270286438/Engineering-Vibration-Inman-D-J">[3]</a>. The output is a
number of eigenvalues, or natural frequencies, and their corresponding
eigenvectors, or mode shapes. As a simple example, consider the lumped mass
solution of two masses connected by three springs as seen in Fig. 2.</p>
<p><img alt="Two masses connected to 3 springs" src="../_images/spring_mass.png" /></p>
<p><em>Two masses connected to 3 springs</em></p>
<p>In the 2-mass system, you have 2 degrees of freedom, so there are 2 differential
equations that describe the motion of masses as such</p>
<p><span class="math notranslate nohighlight">\(m_1 \ddot{x}_1 = -k_1x_1-k_2(x_1-x_2)\)</span>  (3a)</p>
<p><span class="math notranslate nohighlight">\(m_2 \ddot{x}_2 = -k_3x_2-k_2(x_2-x_1)\)</span>  (3b)</p>
<p>where masses 1 and 2 have mass <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span>, respectively, and springs 1, 2,
and 3 have stiffness <span class="math notranslate nohighlight">\(k_1\)</span>, <span class="math notranslate nohighlight">\(k_2\)</span>, and <span class="math notranslate nohighlight">\(k_3\)</span>, respectively. The differential
equations relate acceleration of mass 1 and mass 2, <span class="math notranslate nohighlight">\(\ddot{x}_1\)</span>
and <span class="math notranslate nohighlight">\(\ddot{x}_2\)</span>, to the shape of the system defined by <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>. The mass and stiffness
matrices for this problem becomes</p>
<p><span class="math notranslate nohighlight">\(\mathbf{M}\frac{d^2\mathbf{x}}{dt^2}=-\mathbf{K}\mathbf{x}\)</span> (4a)</p>
<p><span class="math notranslate nohighlight">\(\left[\begin{array}{cc}
m_1 &amp; 0 \\
0 &amp; m_2 \end{array}\right]
\frac{d^2}{dt^2}\left[\begin{array}{c}
x_1 \\
x_2 \end{array}\right]=
-\left[\begin{array}{cc}
k_1+k_2 &amp; -k_2 \\
-k_2 &amp; k_2+k_3 \end{array}\right]
\left[\begin{array}{c}
x_1 \\
x_2 \end{array}\right]\)</span>  (4b)</p>
<div class="section" id="eigenvalues-natural-frequencies">
<h3>Eigenvalues == Natural Frequencies<a class="headerlink" href="#eigenvalues-natural-frequencies" title="Permalink to this headline">¶</a></h3>
<p>The solution for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> will be a combination of sine and cosine functions at
given natural frequencies, depending upon initial conditions, substituting
<span class="math notranslate nohighlight">\(\bar{x}=\bar{u}\sin(\omega t)\)</span> Eqn 4b becomes</p>
<p><span class="math notranslate nohighlight">\(-\omega^2\left[\begin{array}{cc}
m_1 &amp; 0 \\
0 &amp; m_2 \end{array}\right]
\left[\begin{array}{c}
u_1 \\
u_2 \end{array}\right] \sin\omega t=
-\left[\begin{array}{cc}
k_1+k_2 &amp; -k_2 \\
-k_2 &amp; k_2+k_3 \end{array}\right]
\left[\begin{array}{c}
u_1 \\
u_2 \end{array}\right]\sin\omega t\)</span>  (5)</p>
<p>where <span class="math notranslate nohighlight">\(u_1\)</span> and <span class="math notranslate nohighlight">\(u_2\)</span> are amplitudes of the sine function and <span class="math notranslate nohighlight">\(\omega\)</span> is the
natural frequency. Now, the two ordinary differential equations have been
converted to one eigenvalue problem. The eigenvalues, of <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{K}\)</span> are equal to the natural frequencies squared. In the following
example, you calculate the natural frequencies for</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(m_1=m_2\)</span> = 0.2 kg</p></li>
<li><p><span class="math notranslate nohighlight">\(k_1=k_2=k_3\)</span> = 500 N/m.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span><span class="o">=</span><span class="n">m2</span><span class="o">=</span><span class="mf">0.1</span> <span class="c1"># 0.2 kg</span>
<span class="n">k1</span><span class="o">=</span><span class="n">k2</span><span class="o">=</span><span class="n">k3</span><span class="o">=</span><span class="mi">500</span> <span class="c1"># 500 N/m</span>

<span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">m1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">m2</span><span class="p">]])</span>
<span class="n">K</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">,</span><span class="o">-</span><span class="n">k2</span><span class="p">],[</span><span class="o">-</span><span class="n">k2</span><span class="p">,</span><span class="n">k2</span><span class="o">+</span><span class="n">k3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="numpy-s-eig-function">
<h3>Numpy’s <code class="docutils literal notranslate"><span class="pre">eig</span></code> function<a class="headerlink" href="#numpy-s-eig-function" title="Permalink to this headline">¶</a></h3>
<p>Here you have set up the 2-dof system of equations, now you need the eigenvalues to determine the natural frequencies. The eigenvectors give us the relative amplitudes, <span class="math notranslate nohighlight">\(u_1~and~u_2\)</span> for a given frequency.</p>
<p>Below, you save the eigenvalues as <code class="docutils literal notranslate"><span class="pre">e</span></code> and eigenvectors as <code class="docutils literal notranslate"><span class="pre">v</span></code>, using <a class="reference external" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.linalg.eig.html#scipy.linalg.eig">scipy’s linalg.eig</a> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eigenvalue 1:,</span><span class="se">\t</span><span class="s1"> eigenvector 1:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eigenvalue 2:,</span><span class="se">\t</span><span class="s1"> eigenvector 2:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eigenvalue 1:,	 eigenvector 1:
 (5000+0j) 	 [1. 1.]
----------------------
eigenvalue 2:,	 eigenvector 2:
 (15000+0j) 	 [-1.  1.]
</pre></div>
</div>
</div>
</div>
<p>Then, you can determine the natural frequencies of the system by comparing the eigenvalue problem to your system of equations</p>
<ul class="simple">
<li><p><strong>eigenvalue problem:</strong> <span class="math notranslate nohighlight">\(\lambda \mathbf{Mu}=\mathbf{Ku}\)</span></p></li>
<li><p><strong>our system:</strong> <span class="math notranslate nohighlight">\(\omega^2 \mathbf{Mu}=\mathbf{Ku}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\omega = \sqrt{\lambda}\)</span> and <span class="math notranslate nohighlight">\(f=\frac{\omega}{2\pi}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">v1</span><span class="o">=</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">w2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">v2</span><span class="o">=</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1st natural frequency is </span><span class="si">%1.2f</span><span class="s1"> Hz, </span><span class="se">\</span>
<span class="s1">     mode shape: </span><span class="si">%1.0f</span><span class="s1">*x1(t)=</span><span class="si">%1.0f</span><span class="s1">*x2(t)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2nd natural frequency is </span><span class="si">%1.2f</span><span class="s1"> Hz, </span><span class="se">\</span>
<span class="s1">    mode shape: </span><span class="si">%1.0f</span><span class="s1">*x1(t)=</span><span class="si">%1.0f</span><span class="s1">*x2(t)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1st natural frequency is 11.25 Hz,      mode shape: 1*x1(t)=1*x2(t)
2nd natural frequency is 19.49 Hz,     mode shape: -1*x1(t)=1*x2(t)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<p>Increase the stiffness of the springs, <span class="math notranslate nohighlight">\(k_1,~k_2,~and~k_3=2000~N/m.\)</span> What are the natural frequencies? The stiffness increased <span class="math notranslate nohighlight">\(\times 4,\)</span> how much did the natural frequencies change?</p>
</div>
<div class="section" id="linear-algebra-mathbf-ax-b-vs-mathbf-ax-lambda-mathbf-x">
<h3>Linear Algebra: <span class="math notranslate nohighlight">\(\mathbf{Ax=b}\)</span> vs <span class="math notranslate nohighlight">\(\mathbf{Ax}=\lambda\mathbf{x}\)</span><a class="headerlink" href="#linear-algebra-mathbf-ax-b-vs-mathbf-ax-lambda-mathbf-x" title="Permalink to this headline">¶</a></h3>
<p>In <a class="reference external" href="https://github.uconn.edu/rcc02007/CompMech04-LinearAlgebra">CompMech_04-LinearAlgebra</a>, you solved a number of engineering equations of the form,</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Ax=b},\)</span></p>
<p>but here you have another unknown constant, <span class="math notranslate nohighlight">\(\lambda,\)</span> that cannot be separated from <span class="math notranslate nohighlight">\(\mathbf{x}.\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">Eigenvalues</a> are used to solve many different problems including</p>
<ol class="simple">
<li><p>Determining vibrational modes in structural devices</p></li>
<li><p>Material science - vibrational modes of crystal lattices (phonons)</p></li>
<li><p><a class="reference external" href="http://www.rose-hulman.edu/~bryan/googleFinalVersionFixed.pdf">Google searches - http://www.rose-hulman.edu/~bryan/googleFinalVersionFixed.pdf</a></p></li>
<li><p>Quantum mechanics - many solutions are eigenvalue problems</p></li>
<li><p>Solid mechanics, principle stresses and principle stress directions are eigenvalues and eigenvectors</p></li>
</ol>
<p>The natural frequencies are visually shown below in the <strong>Vibration Modes</strong>.</p>
<p><img alt="Vibration modes of 2-mass system when masses are 200 g and 3 springs have stiffness k=500 N/m" src="../_images/eigenvalues.gif" /></p>
<p><em>Vibration modes of 2-mass system when masses are 200 g and 3 springs have stiffness k=500 N/m. The first and second modes are animated on the left and right, respectively.</em></p>
<p>The amplitudes of the displacements will be proportional to the initial
velocities. A <strong>modal analysis</strong> is concerned with the natural frequencies and
mode shapes. This example has two modes (because it has two degrees of freedom).</p>
<p>In mode one, the displacement of mass 1 is equal to mass 2  and <span class="math notranslate nohighlight">\(\omega_{1}=\sqrt{(k_1+k_2)/(m_1+m_2)}\)</span>. In mode two, the
displacement of mass 1 is equal and opposite to mass 2 and <span class="math notranslate nohighlight">\(\omega_{2}=\sqrt{2(k_1+k_2+k_3)/(m_1+m_2)}\)</span>. The natural frequencies
are 11 and 19 Hz, for mode 1 and 2, respectively.</p>
<p>A modal analysis gives us frequencies, but what is the motion if the object are subjected to forces? or impact?</p>
<p>To predict the motion of the system, you use your integration methods from <a class="reference external" href="https://github.uconn.edu/rcc02007/CompMech03-IVPs">CompMech03-IVPs</a>. Set up a new <strong>state</strong> variable, <span class="math notranslate nohighlight">\(\mathbf{z}\)</span></p>
<p><span class="math notranslate nohighlight">\(\mathbf{z} = \left[x_1,~x_2,~\dot{x}_1,~\dot{x}_2\right]\)</span></p>
<p>with its derivative, <span class="math notranslate nohighlight">\(\frac{d (state)}{dt}\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{\mathbf{z}} = \left[\dot{x}_1,~\dot{x}_2,~\ddot{x}_1,~\ddot{x}_2\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(\dot{\mathbf{z}}=\left[\begin{array}{cccc}
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 \\
-\frac{k_1+k_2}{m_1} &amp; \frac{k_2}{m_1} &amp; 0 &amp; 0 \\
\frac{k_2}{m_2} &amp; -\frac{k_2+k_3}{m_2} &amp; 0 &amp; 0
\end{array} \right]
\left[\begin{array}{c}
x_1\\
x_2\\
\dot{x}_1\\
\dot{x}_2\end{array}\right]\)</span></p>
<p>or you can define each <span class="math notranslate nohighlight">\(\dot{\mathbf{z}}\)</span> term in 4 equations:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\dot{z}_1=z_3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{z}_2=z_4\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{z}_3=-\frac{k_1+k_2}{m_1}z_1 + \frac{k_2}{m_1}z_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{z}_4=\frac{k_2}{m_2}z_1 - \frac{k_2+k_3}{m_2}z_2\)</span></p></li>
</ol>
<p>and create your right-hand-side equation that returns <span class="math notranslate nohighlight">\(\dot{\mathbf{z}}\)</span>, given <span class="math notranslate nohighlight">\(\mathbf{z}.\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">spring_mass</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">k1</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">k2</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">k3</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">m1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">m2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Define right-hand-side of 2-DOF spring-mass system</span>
<span class="sd">    |                      |</span>
<span class="sd">    |--\/--m1--\/--m2--\/--|</span>
<span class="sd">    |  k1      k2      k3  |</span>
<span class="sd">    |                      |</span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    state : array of dependent variables (x1,x2,v1,v2)</span>
<span class="sd">    k1 : stiffness in first spring</span>
<span class="sd">    k2 : stiffness in second spring</span>
<span class="sd">    k3 : stiffness in third spring</span>
<span class="sd">    m1 : mass of first mass</span>
<span class="sd">    m2 : mass of second mass</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dstate : the derivative of the state, (v1,v2,a1,a2)</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)))</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">)</span><span class="o">/</span><span class="n">m1</span><span class="p">,</span><span class="n">k2</span><span class="o">/</span><span class="n">m1</span><span class="p">],[</span><span class="n">k2</span><span class="o">/</span><span class="n">m2</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">k2</span><span class="o">+</span><span class="n">k3</span><span class="p">)</span><span class="o">/</span><span class="n">m2</span><span class="p">]])</span>
    <span class="n">dstate</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@state</span>
    <span class="k">return</span> <span class="n">dstate</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="integrating-your-new-function">
<h3>Integrating your new function<a class="headerlink" href="#integrating-your-new-function" title="Permalink to this headline">¶</a></h3>
<p>You redefine the <code class="docutils literal notranslate"><span class="pre">heun_step</span></code> integration method and use the previously calculated eigenvalues to determine the length of time and timestep to integrate. We’ll use the following information,</p>
<ul class="simple">
<li><p>Intial conditions: <span class="math notranslate nohighlight">\(x_1(0)=x_2(0)=\dot{x}_1=0,~\dot{x}_2=-2~m/s\)</span></p></li>
<li><p>Lowest frequency = 11.25 Hz -&gt; one period is T=0.09 s</p></li>
<li><p>Highest frequency = 19.49 Hz -&gt; to achieve 10 steps per period <span class="math notranslate nohighlight">\(\Delta t \approx 0.005~s\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">heun_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">etol</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span><span class="n">maxiters</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Update a state to the next time increment using the implicit Heun&#39;s method.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    state : array of dependent variables</span>
<span class="sd">    rhs   : function that computes the RHS of the DiffEq</span>
<span class="sd">    dt    : float, time increment</span>
<span class="sd">    etol  : tolerance in error for each time step corrector</span>
<span class="sd">    maxiters: maximum number of iterations each time step can take</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    next_state : array, updated after one time increment&#39;&#39;&#39;</span>
    <span class="n">e</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">eps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
    <span class="c1">################### New iterative correction #########################</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxiters</span><span class="p">):</span>
        <span class="n">next_state_old</span> <span class="o">=</span> <span class="n">next_state</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span> <span class="o">+</span> <span class="p">(</span><span class="n">rhs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">+</span><span class="n">rhs</span><span class="p">(</span><span class="n">next_state</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">next_state</span><span class="o">-</span><span class="n">next_state_old</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">next_state</span><span class="o">+</span><span class="n">eps</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">&lt;</span><span class="n">etol</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="c1">############### end of iterative correction #########################</span>
    <span class="k">return</span> <span class="n">next_state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">w1</span> <span class="c1"># 2 x longest period</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">w2</span><span class="o">/</span><span class="mi">10</span> <span class="c1"># shortest period</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">state</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="n">state</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># set initial conditions</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">state</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">heun_step</span><span class="p">(</span><span class="n">state</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">spring_mass</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;position (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_Good_Vibrations_14_0.png" src="../_images/03_Good_Vibrations_14_0.png" />
</div>
</div>
</div>
<div class="section" id="discussion">
<h3>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h3>
<p>This solution looks very different from a sine function, but what if you set the initial condition to one of the eigenvectors? What do you expect?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">w1</span> <span class="c1"># 2 x longest period</span>
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">w2</span><span class="o">/</span><span class="mi">10</span> <span class="c1"># shortest period</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">state_e1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="n">state_e1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># set initial conditions eigenv 1</span>
<span class="n">state_e2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="n">state_e2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.02</span><span class="p">,</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># set initial conditions eigenv 2</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">state_e1</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">heun_step</span><span class="p">(</span><span class="n">state_e1</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">spring_mass</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">state_e2</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">heun_step</span><span class="p">(</span><span class="n">state_e2</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">spring_mass</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eigenvector 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state_e1</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;rs-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state_e1</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;position</span><span class="se">\n</span><span class="s1"> (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eigenvector 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state_e2</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;rs-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">state_e2</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;x_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;position</span><span class="se">\n</span><span class="s1"> (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_Good_Vibrations_17_0.png" src="../_images/03_Good_Vibrations_17_0.png" />
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Exercise<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Give the two masses multiples of the eigenvector for the initial velocities.
e.g. <code class="docutils literal notranslate"><span class="pre">z[:,0]=np.array([0,0,2,2])</span></code> for eigenvector 1.</p>
<p>How does it change the plots for “Eigenvector 1” and “Eigenvector 2”?</p>
</div>
</div>
<div class="section" id="back-to-your-guitar-string">
<h2>Back to your Guitar String<a class="headerlink" href="#back-to-your-guitar-string" title="Permalink to this headline">¶</a></h2>
<p>So, what do two masses connected to springs have to do with your guitar string? The masses had the following equation of motion (if <span class="math notranslate nohighlight">\(m_1=m_2=m\)</span> and <span class="math notranslate nohighlight">\(k_1=k_2=k_3\)</span>)</p>
<p><span class="math notranslate nohighlight">\( m \frac{\partial^2}{\partial t^2}
\left[\begin{array}{c}
x_1\\
x_2\end{array}\right] = -k\left[\begin{array}{cc}
2 &amp; -1\\
-1 &amp; 2\end{array}\right] \left[\begin{array}{c}
x_1\\
x_2\end{array}\right].\)</span></p>
<p>Let’s create a <em>course</em> finite difference of the guitar string PDE using just 4 points <em>(2-DOF)</em> at <span class="math notranslate nohighlight">\(x=0,~1/3,~2/3,~1~m.\)</span> Our goal is to solve for <span class="math notranslate nohighlight">\(y_1~and~y_2\)</span>, because the points at 0 m and 1 m are fixed to y_0=y_4=0. You create your finite difference equations the same way you did in <a class="reference internal" href="02_Keep_it_steady.html"><span class="doc std std-doc">02_Keep_it_steady</span></a>.</p>
<p><span class="math notranslate nohighlight">\(T\frac{\partial^2 y}{\partial x^2} \approx T\frac{y_{i-1}-2y_{i}+y_{i+1}}{h^2} = \mu\frac{\partial^2 y_i}{\partial t^2}\)</span></p>
<p>filling in the boundary conditions and setting up your 2 equations there results</p>
<p><span class="math notranslate nohighlight">\( \mu \frac{\partial^2}{\partial t^2}
\left[\begin{array}{c}
y_1\\
y_2\end{array}\right] = -\frac{T}{h^2}\left[\begin{array}{cc}
2 &amp; -1\\
-1 &amp; 2\end{array}\right] \left[\begin{array}{c}
y_1\\
y_2\end{array}\right].\)</span></p>
<div class="section" id="id2">
<h3>Discussion<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>What are the similarities between your 3-element finite difference of a guitar string equation and the 2-mass 3-spring system?</p>
</div>
<div class="section" id="predicting-your-guitar-string-motion">
<h3>Predicting your guitar string motion<a class="headerlink" href="#predicting-your-guitar-string-motion" title="Permalink to this headline">¶</a></h3>
<p>Using 3 elements is not enough points to predict the shape of the string, but it does illustrate the mathematical analogy between spring-mass systems and travelling waves. Which means you can use the same <strong>eigenvalue</strong> solution to find natural frequencies and integrate the finite difference differential equations with your <code class="docutils literal notranslate"><span class="pre">heun_step</span></code> function.</p>
<p>Let’s extend your finite difference method to solve for 6 y-values, and a standard A-string guitar [1], L=64 cm, <span class="math notranslate nohighlight">\(T=88.3~N\)</span>, and <span class="math notranslate nohighlight">\(\mu=4.5~g/m,\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x=0,~^L/_7,~^{2L}/_7,~^{3L}/_7,~^{4L}/_7,~^{5L}/_7,~^{6L}/_7,~L\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_0=y_7=0~m\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(-\frac{T}{h^2\mu}\left[\begin{array}{cccccc}
2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 2 &amp; -1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -1 &amp; 2 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -1 &amp; 2 &amp; -1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 2 \\
\end{array}\right]
\left[\begin{array}{c}
y_{1}\\
y_{2}\\
y_{3}\\
y_{4}\\
y_{5}\\
y_{6}\end{array}\right]=
\left[\begin{array}{c}
\ddot{y}_1\\
\ddot{y}_2\\
\ddot{y}_3\\
\ddot{y}_4\\
\ddot{y}_5\\
\ddot{y}_6
\end{array}\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(\mathbf{-Ku}\sin\omega t=-\omega^2\mathbf{u}\sin\omega t\)</span></p>
<ul class="simple">
<li><p><strong>eigenvalue problem:</strong> <span class="math notranslate nohighlight">\(\lambda \mathbf{u}=\mathbf{Ku}\)</span></p></li>
<li><p><strong>our guitar system:</strong> <span class="math notranslate nohighlight">\(\omega^2 \mathbf{u}=\mathbf{Ku}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\omega = \sqrt{\lambda}\)</span> and <span class="math notranslate nohighlight">\(f=\frac{\omega}{2\pi}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="mf">0.64</span> <span class="c1"># 64-cm guitar string</span>
<span class="n">T</span><span class="o">=</span><span class="mf">88.29</span> <span class="c1"># 9kg*9.81 m/s/s # N</span>
<span class="n">mu</span><span class="o">=</span><span class="mf">4.5e-3</span> <span class="c1"># kg/m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">6</span> <span class="c1"># 6-node guitar string</span>
<span class="n">dx</span><span class="o">=</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mu</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;K=T/mu/h^2*&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>K=T/mu/h^2*
[[ 2. -1.  0.  0.  0.  0.]
 [-1.  2. -1.  0.  0.  0.]
 [ 0. -1.  2. -1.  0.  0.]
 [ 0.  0. -1.  2. -1.  0.]
 [ 0.  0.  0. -1.  2. -1.]
 [ 0.  0.  0.  0. -1.  2.]]
</pre></div>
</div>
</div>
</div>
<div class="section" id="note-eig-returns-complex-unsorted-eigenvalues">
<h4>Note: <code class="docutils literal notranslate"><span class="pre">eig</span></code> returns complex, unsorted eigenvalues<a class="headerlink" href="#note-eig-returns-complex-unsorted-eigenvalues" title="Permalink to this headline">¶</a></h4>
<p>The function, <a class="reference external" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.linalg.eig.html#scipy.linalg.eig"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code></a>, returns unsorted complex, <span class="math notranslate nohighlight">\((a+ib),\)</span> eigenvalues. You can use the real part <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.real.html"><code class="docutils literal notranslate"><span class="pre">e.real</span></code></a> and put them in ascending order with numpy’s <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.argsort.html"><code class="docutils literal notranslate"><span class="pre">argsort</span></code></a>.</p>
<p><em>The code <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.real.html"><code class="docutils literal notranslate"><span class="pre">e.real</span></code></a> ignores the imaginary part of the function. Here all of the imaginary components are <span class="math notranslate nohighlight">\(\approx 0, \)</span> so you don’t lose any information. Try using <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.imag.html"><code class="docutils literal notranslate"><span class="pre">e.imag</span></code></a> to verify.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="n">isort</span><span class="p">]</span>
<span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">[:,</span><span class="n">isort</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Natural frequencies of </span><span class="si">{}</span><span class="s1">-element string (Hz)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="o">**</span><span class="mf">0.5</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">f1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">fn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Longest time period =</span><span class="si">{:1.3f}</span><span class="s1"> ms</span><span class="se">\n</span><span class="s1">shortest time period =</span><span class="si">{:1.3f}</span><span class="s1"> ms&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">f1</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">fn</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Natural frequencies of 6-element string (Hz)
[108.51469871 211.58801731 304.05142921 381.26843283 439.3670452
 475.43395929]

Longest time period =9.215 ms
shortest time period =2.103 ms
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Exercise<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Plot the first 3 eigenvectors, <code class="docutils literal notranslate"><span class="pre">v[:,0]</span></code>, <code class="docutils literal notranslate"><span class="pre">v[:,1]</span></code>, and <code class="docutils literal notranslate"><span class="pre">v[:,2]</span></code>. The boundary value points have been added below with the function, <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html"><code class="docutils literal notranslate"><span class="pre">np.pad</span></code></a>.</p>
<p><em>Fun fact: guitar string vibration modes take the form <span class="math notranslate nohighlight">\(\sin\left(\frac{n\pi x}{L}\right)\)</span> where <span class="math notranslate nohighlight">\(n=1...\infty,\)</span> and L is the string length.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ymodes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">v</span><span class="p">,((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="c1"># add a 0 to the first row and last row, but add nothing to columns </span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-your-solution-for-y-x-t">
<h2>Creating your solution for y(x,t)<a class="headerlink" href="#creating-your-solution-for-y-x-t" title="Permalink to this headline">¶</a></h2>
<p><img alt="Finite difference representation of wave equation" src="../_images/wave_soln.png" /></p>
<p>The eigenvalue analysis provides a great deal of insight, but it does not give us your final solution of <span class="math notranslate nohighlight">\(y(x,t).\)</span> You can define a new right-hand-side for our state equation using the finite difference description of the guitar string. Here you will use a two-piece state variable where,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{z}=[\mathbf{z_1,~z_2}]=[\mathbf{y,~\dot{y}}]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{\dot{z}}=[\mathbf{\dot{z}_1,~\dot{z}_2}]=[\mathbf{\dot{y},~\ddot{y}}].\)</span></p></li>
</ul>
<p>So that your equations can be generally separated into the kinematic,</p>
<p>equations 1-6:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\dot{z}_1}=\mathbf{z_{2}}\)</span></p>
<p>and the kinetic,</p>
<p>equations 7-14:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\dot{z}_2}-\frac{T}{h^2\mu}\left[\begin{array}{cccccc}
2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 2 &amp; -1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -1 &amp; 2 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; -1 &amp; 2 &amp; -1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 2 \\
\end{array}\right]
\mathbf{z_1}.\)</span></p>
<p>The last missing piece is that you need an initial state for the system, the initial state inludes the position and velocity of each discrete postion</p>
<p><span class="math notranslate nohighlight">\(\mathbf{z}(0) = [\mathbf{y}(0),~\dot{\mathbf{y}}(0)]\)</span></p>
<p>You’ll try two initial states:</p>
<ol class="simple">
<li><p><strong>Mode 1 vibration:</strong> <span class="math notranslate nohighlight">\(y(x,0) = 0.1\sin(\pi x)\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y0</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Initial state 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Initial state 1&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_28_1.png" src="../_images/03_Good_Vibrations_28_1.png" />
</div>
</div>
<ol class="simple">
<li><p><strong>Plucking the string:</strong> <span class="math notranslate nohighlight">\(y(x,0) = 0.1x-0.2(x-1)H(x&gt;L/2)\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y0</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Initial state 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Initial state 2&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_30_1.png" src="../_images/03_Good_Vibrations_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">wave_equation</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span><span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;General Finite Difference Wave Equation</span>
<span class="sd">    in a guitar string</span>
<span class="sd">    of the form T/mu*d^2y/dx^2=d^2y/dt^2</span>
<span class="sd">    Argumemts:</span>
<span class="sd">    ----------</span>
<span class="sd">    state: state of string [position,velocity]</span>
<span class="sd">    T: tension in string</span>
<span class="sd">    mu: string density in kg/m</span>
<span class="sd">    dx: central difference step size()</span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    dstate: derivative of the state= [velocity,acceleration]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mu</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">N_s</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">dstate</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">N_s</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">N_s</span><span class="o">/</span><span class="mi">2</span><span class="p">):]</span>
    <span class="n">dstate</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">N_s</span><span class="o">/</span><span class="mi">2</span><span class="p">):]</span><span class="o">=-</span><span class="n">A</span><span class="nd">@state</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">N_s</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">dstate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="integrate-over-time">
<h3>Integrate over time<a class="headerlink" href="#integrate-over-time" title="Permalink to this headline">¶</a></h3>
<p>You can integrate in the same way you did above for the 2DOF harmonic motion and the differential equations from <a class="reference external" href="https://github.uconn.edu/rcc02007/CompMech03-IVPs">CompMech03-IVPs</a>.</p>
<p>In order to capture enough points to see the motion of the string, you will use two time periods of the smallest frequency</p>
<p><span class="math notranslate nohighlight">\(T_1 = 1/f_1,\)</span> total time <span class="math notranslate nohighlight">\(=2T_1\)</span></p>
<p>and use a time step that produces 10 timesteps per shortest time period</p>
<p><span class="math notranslate nohighlight">\(T_6 = 1/f_6,\)</span> <span class="math notranslate nohighlight">\(\Delta t=h=\frac{T_6}{10}.\)</span></p>
</div>
<div class="section" id="id4">
<h3>Discussion<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Why are you using the Heun, implicit method? Would you use a different method?</p>
</div>
<div class="section" id="solution-1-y-x-0-0-1-sin-pi-x-l">
<h3>1. Solution 1: <span class="math notranslate nohighlight">\(y(x,0) = 0.1\sin(\pi x/L)\)</span><a class="headerlink" href="#solution-1-y-x-0-0-1-sin-pi-x-l" title="Permalink to this headline">¶</a></h3>
<p>Our first solution will look at the vibration of the string if it is released from rest in its lowest frequency mode shape.</p>
<p>You will have a solution for <span class="math notranslate nohighlight">\(\mathbf{y}(x_i,t_j)~and~\dot{\mathbf{y}}(x_i,t_j)\)</span>, so in your case it is a <span class="math notranslate nohighlight">\(6\times88\)</span> array. Each column is the shape of the string and each row is the motion of a single point along the string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">f1</span> 
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fn</span><span class="o">/</span><span class="mi">10</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T1</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">tsteps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">tsteps</span><span class="p">))</span>
<span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">0.01</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
<span class="n">dy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">tsteps</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tsteps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">([</span><span class="n">y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dy</span><span class="p">[:,</span><span class="n">i</span><span class="p">]])</span> <span class="c1"># set z=[y,dy]</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">heun_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">wave_equation</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># get next state</span>
    <span class="n">y</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">next_state</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">]</span> <span class="c1"># save the postions</span>
    <span class="n">dy</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">next_state</span><span class="p">[</span><span class="n">N</span><span class="p">:]</span> <span class="c1"># save the velocities</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;y_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plotting rows of y(x,t)</span><span class="se">\n</span><span class="s1">each line is one point along x-axis&#39;</span><span class="p">)</span>
<span class="c1">##plt.plot(np.arange(0,tsteps)*dt,y[50,:]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Plotting rows of y(x,t)\neach line is one point along x-axis&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_34_1.png" src="../_images/03_Good_Vibrations_34_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ybcs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y</span><span class="p">,((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">ybcs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">::</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">100</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-position (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plotting columns of y(x,t)</span><span class="se">\n</span><span class="s1">each line is one point in time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Plotting columns of y(x,t)\neach line is one point in time&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_35_1.png" src="../_images/03_Good_Vibrations_35_1.png" />
</div>
</div>
<div class="section" id="fancy-3d-plot-to-see-the-whole-y-x-t-stretched-out-over-the-time-and-space-axes">
<h4>Fancy 3D plot to see the whole y(x,t) stretched out over the time and space axes<a class="headerlink" href="#fancy-3d-plot-to-see-the-whole-y-x-t-stretched-out-over-the-time-and-space-axes" title="Permalink to this headline">¶</a></h4>
<p>Below is a illustration of the entire array <span class="math notranslate nohighlight">\(y(x_i,t_j).\)</span> The x-axis is position, x, the y-axis is the time, t, and the z-axis is the predicted <code class="docutils literal notranslate"><span class="pre">y[i,j]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">axes3d</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">TT</span><span class="p">,</span><span class="n">XX</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">TT</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="n">ybcs</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">))</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">TT</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ybcs</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">TT</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ybcs</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">cset</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">TT</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ybcs</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">time </span><span class="se">\n</span><span class="s1">(ms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">x-position </span><span class="se">\n</span><span class="s1">(cm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">y-position </span><span class="se">\n</span><span class="s1">(cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;string.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_Good_Vibrations_37_0.png" src="../_images/03_Good_Vibrations_37_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="solution-2-y-x-0-0-1x-0-2h-x-l-2-x-l-2">
<h3>2. Solution 2: <span class="math notranslate nohighlight">\(y(x,0) = 0.1x-0.2H(x-L/2)(x-L/2)\)</span><a class="headerlink" href="#solution-2-y-x-0-0-1x-0-2h-x-l-2-x-l-2" title="Permalink to this headline">¶</a></h3>
<p>In this second solution, you will increase the spatial resolution of your finite difference method to <span class="math notranslate nohighlight">\(h=L/61.\)</span></p>
<p>You will have a solution for <span class="math notranslate nohighlight">\(\mathbf{y}(x_i,t_j)~and~\dot{\mathbf{y}}(x_i,t_j)\)</span>, so in your case it is a <span class="math notranslate nohighlight">\(60\times10T_{60}\)</span> array. As before, each column is the shape of the string and each row is the motion of a single point along the string.</p>
<p>Here, the motion will be a little more interesting, so you will create an animation and a sound recording of the result using</p>
<ul class="simple">
<li><p><a class="reference external" href="http://louistiao.me/posts/notebooks/embedding-matplotlib-animations-in-jupyter-as-interactive-javascript-widgets/">matplotlib’s animation in HTML5</a></p></li>
<li><p>Wav-file writer, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.write.html">scipy.io.wavfile</a></p></li>
</ul>
<p><strong>First, set up the eigenvalue problem and solve for min/max frequencies and time periods.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="mf">0.64</span> <span class="c1"># 64-cm guitar string</span>
<span class="n">T</span><span class="o">=</span><span class="mf">88.29</span> <span class="c1"># 9kg*9.81 m/s/s # N</span>
<span class="n">mu</span><span class="o">=</span><span class="mf">4.5e-3</span> <span class="c1"># kg/m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">60</span> <span class="c1"># 60-node guitar string</span>
<span class="n">dx</span><span class="o">=</span><span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mu</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>\
       <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="n">isort</span><span class="p">]</span>
<span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">real</span><span class="p">[:,</span><span class="n">isort</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First 10 Natural frequencies of </span><span class="si">{}</span><span class="s1">-element string (Hz)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">f1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">fn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Longest time period =</span><span class="si">{:1.3f}</span><span class="s1"> ms</span><span class="se">\n</span><span class="s1">shortest time period =</span><span class="si">{:1.3f}</span><span class="s1"> ms&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">f1</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">fn</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First 10 Natural frequencies of 60-element string (Hz)
[ 109.41869579  218.76483987  327.96592865  436.94955472  545.64345484
  653.97555789  761.87403267  869.26733545  976.08425752 1082.25397231]

Longest time period =9.139 ms
shortest time period =0.235 ms
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h3>Exercise<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Plot the first 3 vibration modes as you did for the 6-node guitar string. What is different? How would you describe the <em>convergence</em>?</p>
</div>
<div class="section" id="increase-length-of-simulation">
<h3>Increase length of simulation<a class="headerlink" href="#increase-length-of-simulation" title="Permalink to this headline">¶</a></h3>
<p>The motion of the string is a little more interesting and complicated in this example. In order to capature the full motion of the string, we’ll use 10 periods of the lowest frequency and maintain timesteps of <span class="math notranslate nohighlight">\(T_{60}/10,\)</span> the shortest time period vibration mode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">/</span><span class="n">f1</span> 
<span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fn</span><span class="o">/</span><span class="mi">10</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T1</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
<span class="n">tsteps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">tsteps</span><span class="p">))</span>
<span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">tsteps</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tsteps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">([</span><span class="n">y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">dy</span><span class="p">[:,</span><span class="n">i</span><span class="p">]])</span> <span class="c1"># set z=[y,dy]</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">heun_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">wave_equation</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span> <span class="c1"># get next state</span>
    <span class="n">y</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">next_state</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">]</span> <span class="c1"># save the postions</span>
    <span class="n">dy</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">next_state</span><span class="p">[</span><span class="n">N</span><span class="p">:]</span> <span class="c1"># save the velocities</span>

<span class="n">ybcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y</span><span class="p">,((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;y_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time(s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plotting half the rows of y(x,t)</span><span class="se">\n</span><span class="s1">each line is one point along x-axis&#39;</span><span class="p">)</span>
<span class="c1">##plt.plot(np.arange(0,tsteps)*dt,y[50,:]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Plotting half the rows of y(x,t)\neach line is one point along x-axis&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_46_1.png" src="../_images/03_Good_Vibrations_46_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ybcs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y</span><span class="p">,((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">ybcs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">::</span><span class="mi">50</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">100</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-position (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (cm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plotting columns of y(x,t)</span><span class="se">\n</span><span class="s1">each line is one point in time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Plotting columns of y(x,t)\neach line is one point in time&#39;)
</pre></div>
</div>
<img alt="../_images/03_Good_Vibrations_47_1.png" src="../_images/03_Good_Vibrations_47_1.png" />
</div>
</div>
</div>
<div class="section" id="visualizing-the-motion">
<h3>Visualizing the motion<a class="headerlink" href="#visualizing-the-motion" title="Permalink to this headline">¶</a></h3>
<p>It may be hard to visualize what this motion is really like. Let’s create an <a class="reference external" href="https://matplotlib.org/3.2.1/api/animation_api.html">animation</a> of the string. First, you import two animation libraries:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://matplotlib.org/3.2.1/api/animation_api.html">matplotlib’s <code class="docutils literal notranslate"><span class="pre">animation</span></code> library</a></p></li>
<li><p><a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html#classes">IPython.display’s <code class="docutils literal notranslate"><span class="pre">HTML</span></code> library</a></p></li>
</ul>
<p>Then, you have a few set-up cells to create the animation</p>
<ol class="simple">
<li><p>Create a figure to display the animation and add fixed background</p></li>
<li><p>Create an initializing (<code class="docutils literal notranslate"><span class="pre">init</span></code>) function that clears the previous line</p></li>
<li><p>Create an animating (<code class="docutils literal notranslate"><span class="pre">animate</span></code>) function that updates the line</p></li>
<li><p>Create an animation (<code class="docutils literal notranslate"><span class="pre">anim</span></code>) variable using the <code class="docutils literal notranslate"><span class="pre">animation.FuncAnimation</span></code></p></li>
<li><p>Display the animation (<code class="docutils literal notranslate"><span class="pre">anim</span></code>) in an HTML5 output</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Create a figure to display the animation and add fixed background</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x-position (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_Good_Vibrations_51_0.png" src="../_images/03_Good_Vibrations_51_0.png" />
</div>
</div>
<ol class="simple">
<li><p>Create an initializing (<code class="docutils literal notranslate"><span class="pre">init</span></code>) function that clears the previous line</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">line</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Create an animating (<code class="docutils literal notranslate"><span class="pre">animate</span></code>) function that updates the line</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ybcs</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">line</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Create an animation (<code class="docutils literal notranslate"><span class="pre">anim</span></code>) variable using the <code class="docutils literal notranslate"><span class="pre">animation.FuncAnimation</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
                               <span class="n">frames</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tsteps</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                               <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Animation of String from t=0-</span><span class="si">{:.1f}</span><span class="s1"> ms every </span><span class="si">{:.2f}</span><span class="s1"> ms&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Animation of String from t=0-91.4 ms every 0.24 ms
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Display the animation (<code class="docutils literal notranslate"><span class="pre">anim</span></code>) in an HTML5 output  <strong>Note: this <code class="docutils literal notranslate"><span class="pre">HTML</span></code> function takes a while to run. If you haven’t changed the above code, you don’t need to run the cell.</strong></p></li>
</ol>
</div>
<div class="section" id="animation-of-string-from">
<h3>Animation of String from<a class="headerlink" href="#animation-of-string-from" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="t-0-91-4-ms-frame-every-0-24-ms">
<h3>t=0-91.4 ms frame every 0.24 ms<a class="headerlink" href="#t-0-91-4-ms-frame-every-0-24-ms" title="Permalink to this headline">¶</a></h3>
<p>Below you have the fruits of your toils, you can watch the wave travelling from the center to the boundaries, then reflect back to each other. It’s amazing how you can take a simple relation like the wave equation and come up with a realistic slow-motion view of reality.</p>
<p><strong>Guitar string equation:</strong> <span class="math notranslate nohighlight">\(\mu\frac{\partial^2 y}{\partial t^2}=T\frac{\partial ^2 y}{\partial x^2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_2005</span><span class="o">/</span><span class="mf">4267696184.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.7/x64/lib/python3.9/site-packages/matplotlib/animation.py</span> in <span class="ni">to_html5_video</span><span class="nt">(self, embed_limit)</span>
<span class="g g-Whitespace">   </span><span class="mi">1346</span>                 <span class="c1"># We create a writer manually so that we can get the</span>
<span class="g g-Whitespace">   </span><span class="mi">1347</span>                 <span class="c1"># appropriate size for the tag</span>
<span class="ne">-&gt; </span><span class="mi">1348</span>                 <span class="n">Writer</span> <span class="o">=</span> <span class="n">writers</span><span class="p">[</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;animation.writer&#39;</span><span class="p">]]</span>
<span class="g g-Whitespace">   </span><span class="mi">1349</span>                 <span class="n">writer</span> <span class="o">=</span> <span class="n">Writer</span><span class="p">(</span><span class="n">codec</span><span class="o">=</span><span class="s1">&#39;h264&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1350</span>                                 <span class="n">bitrate</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;animation.bitrate&#39;</span><span class="p">],</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.7/x64/lib/python3.9/site-packages/matplotlib/animation.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_available</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registered</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">151</span>         <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested MovieWriter (</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">) not available&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span> 
<span class="g g-Whitespace">    </span><span class="mi">153</span> 

<span class="ne">RuntimeError</span>: Requested MovieWriter (ffmpeg) not available
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="listen-to-your-data">
<h2>Listen to your data<a class="headerlink" href="#listen-to-your-data" title="Permalink to this headline">¶</a></h2>
<p>In this application, it would be great if you could record your work and <em>listen</em> to it. Your ears are great at recognizing small changes in pitch (natural frequency). In the Python ecosystem, there is an <code class="docutils literal notranslate"><span class="pre">Audio</span></code> display option. First, you import our display into Jupyter, then you give it an array to listen to. First, let’s listen to a pure 110-Hz A note.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span>
</pre></div>
</div>
</div>
</div>
<p>A-note = <span class="math notranslate nohighlight">\(\sin(110~Hz~2\pi \frac{rad}{cycle}t)\)</span></p>
<p>Amplify by 100 for volume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="mi">20000</span>
<span class="n">tsig</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">r</span><span class="p">)</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">110</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">tsig</span><span class="p">),</span><span class="n">rate</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>Exercise<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Create a 1-second audio clip of the 440-Hz A note.</p>
</div>
<div class="section" id="listen-to-your-simulated-guitar">
<h3>Listen to your simulated Guitar<a class="headerlink" href="#listen-to-your-simulated-guitar" title="Permalink to this headline">¶</a></h3>
<p>A pick-up on an electric guitar works by magnetizing the steel guitar string and monitoring the magnetic flux produced due to vibrations. This means the sound produced is proportional to the velocity of the string on top of the pick-up [3]. You already calculated the velocity of the guitar strings in your variable <code class="docutils literal notranslate"><span class="pre">dy</span></code>. Now, you can produce the sound by using the velocity near the base of the guitar, <code class="docutils literal notranslate"><span class="pre">dy[0,:]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samplerate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">out_file</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dy</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out_file</span><span class="p">,</span><span class="n">rate</span><span class="o">=</span><span class="n">samplerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">out_file</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="n">out_file</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;input signal (a.u.)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h3>Discussion<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Typically guitars will have some filter to get rid of some of the background noise. Would you want to get rid of low frequency (&lt;100 Hz) or high frequency (&gt;1000 Hz) to make your recording better?</p>
</div>
</div>
<div class="section" id="what-you-ve-learned">
<h2>What You’ve Learned<a class="headerlink" href="#what-you-ve-learned" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How to set up and solve an eigenvalue problem</p></li>
<li><p>How eigenvalues and eigenvectors relate to natural frequencies and mode shapes</p></li>
<li><p>How to turn a <em>PDE</em> into a finite difference <em>ODE</em></p></li>
<li><p>How to use eigenvalues to calculate natural frequencies of a vibrating string</p></li>
<li><p>How to solve a coupled set of <em>ODEs</em></p></li>
<li><p>Visualize solutions to finite difference equations with 3D plots and animations</p></li>
<li><p>How to <em>listen</em> to vibration solutions</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="http://www.noyceguitars.com/technotes/articles/t3.html">Noyce Guitars:String Tension</a></p></li>
<li><p><a class="reference external" href="http://louistiao.me/posts/notebooks/embedding-matplotlib-animations-in-jupyter-as-interactive-javascript-widgets/">Tiao, Louis. Embedding animations in Jupyter</a></p></li>
<li><p><a class="reference external" href="https://www.guitarworld.com/gear/how-does-a-guitar-pickup-really-work">Lawling, Scott. How Does a Guitar Pickup Really Work?</a></p></li>
</ol>
</div>
</div>
<div class="section" id="problems">
<h1>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h1>
<p><img alt="Two masses connected to 3 springs" src="../_images/spring_mass.png" /></p>
<p><em>Two masses connected to 3 springs</em></p>
<ol class="simple">
<li><p>Use the 2-DOF harmonic oscillator shown considering <span class="math notranslate nohighlight">\(m_1=m_2=0.1~kg\)</span>, <span class="math notranslate nohighlight">\(k_1=k_3=1000~N/m,\)</span> and <span class="math notranslate nohighlight">\(k_2=500~N/m\)</span>.</p></li>
</ol>
<p>a. Calculate the natural frequencies and mode shapes <em>(eigenvectors)</em>.</p>
<p>b. Plot the position of <span class="math notranslate nohighlight">\(x_1~and~x_2\)</span> if the masses are at rest when mass 2 is given an initial velocity of 2 m/s.</p>
<ol class="simple">
<li><p>Consider the G-string on the guitar, L=0.64 m, <span class="math notranslate nohighlight">\(\mu=1.14~g/m,\)</span> and T=71.81 N [1].</p></li>
</ol>
<p><strong>Guitar string equation:</strong> <span class="math notranslate nohighlight">\(\mu\frac{\partial^2 y}{\partial t^2}=T\frac{\partial ^2 y}{\partial x^2}\)</span></p>
<p>a. Calculate the first and second natural frequencies using 6, 30, 45, and 60 nodes. Plot the mode shapes to demonstrate convergence.</p>
<p>b. Use 60 nodes to create an animation using the following initial condition, <span class="math notranslate nohighlight">\(y(x,0)=0\)</span> and <span class="math notranslate nohighlight">\(\dot{y}(L/2,0)=2~m/s.\)</span> e.g. <code class="docutils literal notranslate"><span class="pre">dy[30,0]=2</span></code>.</p>
<p>c. Use 60 nodes to create an audio display using the following initial condition, <span class="math notranslate nohighlight">\(y(x,0)=0\)</span> and <span class="math notranslate nohighlight">\(\dot{y}(L/2,0)=2~m/s.\)</span> e.g. <code class="docutils literal notranslate"><span class="pre">dy[30,0]=2</span></code>.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./module_05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="02_Keep_it_steady.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Keep it Steady</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../projects/05-BVPs_project.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Computational Mechanics Boundary Values - Project 05</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Ryan C. Cooper<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>