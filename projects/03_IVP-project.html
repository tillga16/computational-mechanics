
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Initial Value Problems - Project &#8212; Computational Mechanics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Computational Mechanics 4 - Linear Algebra" href="../module_04/README.html" />
    <link rel="prev" title="Roots of Nonlinear functions" href="../module_03/04_Getting_to_the_root.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/comp-mech-logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Computational Mechanics
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus - Computational Mechanics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../how-to/update-github.html">
   Working in your  Fork on GitHub.com
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_01/README.html">
   Computational Mechanics 01 - Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/01_Interacting_with_Python.html">
     01 - Interacting with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/02_Working_with_Python.html">
     02 - Working with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/03_Numerical_error.html">
     03 - Numerical Error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_Getting-started-project.html">
     Computational Mechanics Project #01 - Heat Transfer in Forensic Science
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_02/README.html">
   Computational Mechanics 02 - Analyze Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/01_Cheers_Stats_Beers.html">
     01 - Cheers!  Stats with Beers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/02_Seeing_Stats.html">
     02 - Seeing stats in a new light
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/03_Linear_Regression_with_Real_Data.html">
     03 - Linear regression with real data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_02/04_Stats_and_Montecarlo.html">
     04 - Statistics and Monte-Carlo Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_Analyze-data_project.html">
     Project #02 - NYSE random walk predictor
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../module_03/README.html">
   Computational Mechanics 03- Initial Value Problems
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/01_Catch_Motion.html">
     Catch things in motion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/02_Step_Future.html">
     Step to the future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/03_Get_Oscillations.html">
     Get with the oscillations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/04_Getting_to_the_root.html">
     Roots of Nonlinear functions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Initial Value Problems - Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_04/README.html">
   Computational Mechanics 4 - Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/01_Linear-Algebra.html">
     Linear Algebra Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/02_Gauss_elimination.html">
     Gauss Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/03_Linear-regression-algebra.html">
     Linear Regression Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_Linear_Algebra-project.html">
     CompMech04-Linear Algebra Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_05/README.html">
   Computational Mechanics 5 - Boundary Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/01_Revisiting_derivatives.html">
     Revisiting Derivatives
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/02_Keep_it_steady.html">
     Keep it Steady
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/03_Good_Vibrations.html">
     Good Vibrations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05-BVPs_project.html">
     Computational Mechanics Boundary Values - Project 05
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../how-to/README.html">
   Quick How-to documents
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/update-github.html">
     Working in your  Fork on GitHub.com
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/polyfit.html">
     Creating a quadratic fit on random data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/for-loops.html">
     How to use a
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loop?
     <em>
      in Python
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="extra-FEA_material.html">
     Extra Material: Direct stiffness method for Finite Element analysis (FEA)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/projects/03_IVP-project.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/projects/03_IVP-project.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cooperrc/computational-mechanics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cooperrc/computational-mechanics/issues/new?title=Issue%20on%20page%20%2Fprojects/03_IVP-project.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cooperrc/computational-mechanics/master?urlpath=tree/projects/03_IVP-project.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://compmech.uconn.edu/hub/user-redirect/git-pull?repo=https://github.com/cooperrc/computational-mechanics&urlpath=tree/computational-mechanics/projects/03_IVP-project.md&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="initial-value-problems-project">
<h1>Initial Value Problems - Project<a class="headerlink" href="#initial-value-problems-project" title="Permalink to this headline">¶</a></h1>
<p><img alt="Initial condition of firework with FBD and sum of momentum" src="../_images/firework.png" /></p>
<p>You are going to end this module with a <strong>bang</strong> by looking at the
flight path of a firework. Shown above is the initial condition of a
firework, the <em>Freedom Flyer</em> in (a), its final height where it
detonates in (b), the applied forces in the <strong>Free Body Diagram (FBD)</strong>
in (c), and the <strong>momentum</strong> of the firework <span class="math notranslate nohighlight">\(m\mathbf{v}\)</span> and the
propellent <span class="math notranslate nohighlight">\(dm \mathbf{u}\)</span> in (d).</p>
<p>The resulting equation of motion is that the acceleration is
proportional to the speed of the propellent and the mass rate change
<span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span> as such</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
m\frac{dv}{dt} = u\frac{dm}{dt} -mg - cv^2.~~~~~~~~(1)
\end{equation}\]</div>
<p>If you assume that the acceleration and the propellent momentum are much
greater than the forces of gravity and drag, then the equation is
simplified to the conservation of momentum. A further simplification is
that the speed of the propellant is constant, <span class="math notranslate nohighlight">\(u=constant\)</span>, then the
equation can be integrated to obtain an analytical rocket equation
solution of <a class="reference external" href="https://www.math24.net/rocket-motion/">Tsiolkovsky</a> [1,2],</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
m\frac{dv}{dt} = u\frac{dm}{dt}~~~~~(2.a)
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[\begin{equation}
\frac{m_{f}}{m_{0}}=e^{-\Delta v / u},~~~~~(2.b) 
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(m_f\)</span> and <span class="math notranslate nohighlight">\(m_0\)</span> are the mass at beginning and end of flight, <span class="math notranslate nohighlight">\(u\)</span>
is the speed of the propellent, and <span class="math notranslate nohighlight">\(\Delta v=v_{final}-v_{initial}\)</span> is
the change in speed of the rocket from beginning to end of flight.
Equation 2.b only relates the final velocity to the change in mass and
propellent speed. When you integrate Eqn 2.a, you will have to compare
the velocity as a function of mass loss.</p>
<p>Your first objective is to integrate a numerical model that converges to
equation (2.b), the Tsiolkovsky equation. Next, you will add drag and
gravity and compare the results <em>between equations (1) and (2)</em>.
Finally, you will vary the mass change rate to achieve the desired
detonation height.</p>
<p><strong>1.</strong> Create a <code class="docutils literal notranslate"><span class="pre">simplerocket</span></code> function that returns the velocity, <span class="math notranslate nohighlight">\(v\)</span>,
the acceleration, <span class="math notranslate nohighlight">\(a\)</span>, and the mass rate change <span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span>, as a
function of the <span class="math notranslate nohighlight">\(state = [position,~velocity,~mass] = [y,~v,~m]\)</span> using
eqn (2.a). Where the mass rate change <span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span> and the propellent
speed <span class="math notranslate nohighlight">\(u\)</span> are constants. The average velocity of gun powder propellent
used in firework rockets is <span class="math notranslate nohighlight">\(u=250\)</span> m/s [3,4].</p>
<p><span class="math notranslate nohighlight">\(\frac{d~state}{dt} = f(state)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left[\begin{array}{c} v\\a\\ \frac{dm}{dt} \end{array}\right] = \left[\begin{array}{c} v\\ \frac{u}{m}\frac{dm}{dt} \\ \frac{dm}{dt} \end{array}\right]\)</span></p>
<p>Use <a class="reference internal" href="../module_03/03_Get_Oscillations.html"><span class="doc std std-doc">an integration method</span></a> to
integrate the <code class="docutils literal notranslate"><span class="pre">simplerocket</span></code> function. Demonstrate that your solution
converges to equation (2.b) the Tsiolkovsky equation. Use an initial
state of y=0 m, v=0 m/s, and m=0.25 kg.</p>
<p>Integrate the function until mass, <span class="math notranslate nohighlight">\(m_{f}=0.05~kg\)</span>, using a mass rate change of <span class="math notranslate nohighlight">\(\frac{dm}{dt}=0.05\)</span> kg/s.</p>
<blockquote>
<div><p><strong>Hint</strong>: your integrated solution will have a current mass that you can
use to create <span class="math notranslate nohighlight">\(\frac{m_{f}}{m_{0}}\)</span> by dividing state[2]/(initial mass),
then your plot of velocity(t) vs mass(t)/mass(0) should match
Tsiolkovsky’s</p>
<p><span class="math notranslate nohighlight">\(\log\left(\frac{m_{f}}{m_{0}}\right) =
\log\left(\frac{state[2]}{0.25~kg}\right) 
= \frac{state[1]}{250~m/s} = \frac{-\Delta v+error}{u}\)</span>
where <span class="math notranslate nohighlight">\(error\)</span> is the difference between your integrated state variable
and the Tsiolkovsky analytical value.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simplerocket</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">dmdt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">250</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes the right-hand side of the differential equation</span>
<span class="sd">    for the acceleration of a rocket, without drag or gravity, in SI units.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ----------    </span>
<span class="sd">    state : array of three dependent variables [y v m]^T</span>
<span class="sd">    dmdt : mass rate change of rocket in kilograms/s default set to 0.05 kg/s</span>
<span class="sd">    u    : speed of propellent expelled (default is 250 m/s)</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    derivs: array of three derivatives [v (u/m*dmdt-g-c/mv^2) -dmdt]^T</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">dstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">dmdt</span><span class="p">)</span> <span class="o">/</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dmdt</span>

    <span class="k">return</span> <span class="n">dstate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m0</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">mf</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">dm</span><span class="o">=</span><span class="mf">0.05</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">dt</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="k">return</span> <span class="n">next_state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m0</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="n">num_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">num_sol</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler_step</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">simplerocket</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simple Rocket&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time vs. Height of Simple Rocket&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_8_0.png" src="../_images/03_IVP-project_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Simple Rocket (Mass)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_9_0.png" src="../_images/03_IVP-project_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Simple Rocket (Velocity)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_10_0.png" src="../_images/03_IVP-project_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Simple Rocket (Velocity vs. Mass)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_11_0.png" src="../_images/03_IVP-project_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m0</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">mf</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">dm</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">Tsiolkovsky</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">m0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Simple Rocket&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">Tsiolkovsky</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Tsiolkovsky Equation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_12_0.png" src="../_images/03_IVP-project_12_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Tsiolkovsky</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>402.3594781085134
401.559160028918
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">1600</span><span class="p">,</span><span class="mi">3200</span><span class="p">,</span><span class="mi">6400</span><span class="p">,</span><span class="mi">12800</span><span class="p">,</span><span class="mi">64000</span><span class="p">,</span><span class="mi">128000</span><span class="p">,</span><span class="mi">640000</span><span class="p">])</span>

<span class="n">num_sol_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">N_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_values</span><span class="p">):</span>
    <span class="n">m0</span><span class="o">=</span><span class="mf">0.25</span>
    <span class="n">mf</span><span class="o">=</span><span class="mf">0.05</span>
    <span class="n">dm</span><span class="o">=</span><span class="mf">0.05</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">num_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

    <span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
    <span class="n">num_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">num_sol</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler_step</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">simplerocket</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="n">num_sol_time</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_sol</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_error</span><span class="p">(</span><span class="n">num_sol</span><span class="p">):</span>
    
    <span class="n">x_an</span> <span class="o">=</span> <span class="n">Tsiolkovsky</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># analytical solution at final time</span>
    
    <span class="n">error</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_an</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">error</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">N_values</span><span class="p">))</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">N_values</span><span class="p">)):</span>
    
    <span class="n">error_values</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_error</span><span class="p">(</span><span class="n">num_sol_time</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(((</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">)</span><span class="o">/</span><span class="n">N_values</span><span class="p">,</span> <span class="n">error_values</span><span class="p">,</span> <span class="s1">&#39;ko-&#39;</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>                     
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\Delta t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convergence of the Rocket Trajectory to Tsiolkovsky Equation&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_17_0.png" src="../_images/03_IVP-project_17_0.png" />
</div>
</div>
<p>The plot above shows that as the time step decreases, the rocket trajectory found using the Euler method converges towards the Tsiolkovsky Equation of rocket motion.</p>
<p>The slope of this plot shows that the Euler method is a first-order method, which we know from previous modules</p>
<p><strong>2.</strong> You should have a converged solution for integrating <code class="docutils literal notranslate"><span class="pre">simplerocket</span></code>. Now, create a more relastic function, <code class="docutils literal notranslate"><span class="pre">rocket</span></code> that incorporates gravity and drag and returns the velocity, <span class="math notranslate nohighlight">\(v\)</span>, the acceleration, <span class="math notranslate nohighlight">\(a\)</span>, and the mass rate change <span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span>, as a function of the <span class="math notranslate nohighlight">\(state = [position,~velocity,~mass] = [y,~v,~m]\)</span> using eqn (1). Where the mass rate change <span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span> and the propellent speed <span class="math notranslate nohighlight">\(u\)</span> are constants. The average velocity of gun powder propellent used in firework rockets is <span class="math notranslate nohighlight">\(u=250\)</span> m/s [3,4].</p>
<p><span class="math notranslate nohighlight">\(\frac{d~state}{dt} = f(state)\)</span></p>
<p><span class="math notranslate nohighlight">\(\left[\begin{array}{c} v\\a\\ \frac{dm}{dt} \end{array}\right] = 
\left[\begin{array}{c} v\\ \frac{u}{m}\frac{dm}{dt}-g-\frac{c}{m}v^2 \\ \frac{dm}{dt} \end{array}\right]\)</span></p>
<p>Use <span class="xref myst">two integration methods</span> to integrate the <code class="docutils literal notranslate"><span class="pre">rocket</span></code> function, one explicit method and one implicit method. Demonstrate that the solutions converge to equation (2.b) the Tsiolkovsky equation. Use an initial state of y=0 m, v=0 m/s, and m=0.25 kg.</p>
<p>Integrate the function until mass, <span class="math notranslate nohighlight">\(m_{f}=0.05~kg\)</span>, using a mass rate change of <span class="math notranslate nohighlight">\(\frac{dm}{dt}=0.05\)</span> kg/s, .</p>
<p>Compare solutions between the <code class="docutils literal notranslate"><span class="pre">simplerocket</span></code> and <code class="docutils literal notranslate"><span class="pre">rocket</span></code> integration, what is the height reached when the mass reaches <span class="math notranslate nohighlight">\(m_{f} = 0.05~kg?\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rocket</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">dmdt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mf">0.18e-3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes the right-hand side of the differential equation</span>
<span class="sd">    for the acceleration of a rocket, with drag, in SI units.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ----------    </span>
<span class="sd">    state : array of three dependent variables [y v m]^T</span>
<span class="sd">    dmdt : mass rate change of rocket in kilograms/s default set to 0.05 kg/s</span>
<span class="sd">    u    : speed of propellent expelled (default is 250 m/s)</span>
<span class="sd">    c : drag constant for a rocket set to 0.18e-3 kg/m</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    derivs: array of three derivatives [v (u/m*dmdt-g-c/mv^2) -dmdt]^T</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span>
    <span class="n">dstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">/</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">dmdt</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dmdt</span>
    <span class="k">return</span> <span class="n">dstate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">m0</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">num_sold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">num_sold</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">num_sold</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">num_sold</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">num_sold</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler_step</span><span class="p">(</span><span class="n">num_sold</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rocket</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_sold</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Euler)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_22_0.png" src="../_images/03_IVP-project_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">heun_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">etol</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span><span class="n">maxiters</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="n">e</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
    <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxiters</span><span class="p">):</span>
        <span class="n">next_state_old</span> <span class="o">=</span> <span class="n">next_state</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span> <span class="o">+</span> <span class="p">(</span><span class="n">rhs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">+</span><span class="n">rhs</span><span class="p">(</span><span class="n">next_state</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">next_state</span><span class="o">-</span><span class="n">next_state_old</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">next_state</span><span class="o">+</span><span class="n">eps</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">&lt;</span><span class="n">etol</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">return</span> <span class="n">next_state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_solh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">num_solh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">heun_step</span><span class="p">(</span><span class="n">num_solh</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rocket</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_solh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Heun)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_IVP-project_25_0.png" src="../_images/03_IVP-project_25_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sold</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sold</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Euler)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_solh</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_solh</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Heun)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">Tsiolkovsky</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Tsiolkovsky Equation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_2159</span><span class="o">/</span><span class="mf">1881626248.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sold</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sold</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Euler)&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_solh</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_solh</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Heun)&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">Tsiolkovsky</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Tsiolkovsky Equation&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity (m/s)&#39;</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.9/x64/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">plot</span><span class="nt">(scalex, scaley, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2755</span> <span class="nd">@_copy_docstring_and_deprecators</span><span class="p">(</span><span class="n">Axes</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2756</span> <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">scalex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scaley</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2757</span>     <span class="k">return</span> <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2758</span>         <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">scalex</span><span class="o">=</span><span class="n">scalex</span><span class="p">,</span> <span class="n">scaley</span><span class="o">=</span><span class="n">scaley</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2759</span>         <span class="o">**</span><span class="p">({</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span> <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.9/x64/lib/python3.9/site-packages/matplotlib/axes/_axes.py</span> in <span class="ni">plot</span><span class="nt">(self, scalex, scaley, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1630</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1631</span><span class="s2">         kwargs = cbook.normalize_kwargs(kwargs, mlines.Line2D)</span>
<span class="ne">-&gt; </span><span class="mi">1632</span><span class="s2">         lines = [*self._get_lines(*args, data=data, **kwargs)]</span>
<span class="g g-Whitespace">   </span><span class="mi">1633</span><span class="s2">         for line in lines:</span>
<span class="g g-Whitespace">   </span><span class="mi">1634</span><span class="s2">             self.add_line(line)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.9/x64/lib/python3.9/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">__call__</span><span class="nt">(self, data, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span><span class="s2">                 this += args[0],</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span><span class="s2">                 args = args[1:]</span>
<span class="ne">--&gt; </span><span class="mi">312</span><span class="s2">             yield from self._plot_args(this, kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">314</span><span class="s2">     def get_next_color(self):</span>

<span class="nn">/opt/hostedtoolcache/Python/3.9.9/x64/lib/python3.9/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">_plot_args</span><span class="nt">(self, tup, kwargs, return_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">497</span><span class="s2">         if x.shape[0] != y.shape[0]:</span>
<span class="ne">--&gt; </span><span class="mi">498</span><span class="s2">             raise ValueError(f&quot;x and y must have same first dimension, but &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">499</span><span class="s2">                              f&quot;have shapes </span><span class="si">{x.shape}</span><span class="s2"> and </span><span class="si">{y.shape}</span><span class="s2">&quot;)</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span><span class="s2">         if x.ndim &gt; 2 or y.ndim &gt; 2:</span>

<span class="ne">ValueError</span>: x and y must have same first dimension, but have shapes (640000,) and (500,)
</pre></div>
</div>
<img alt="../_images/03_IVP-project_26_1.png" src="../_images/03_IVP-project_26_1.png" />
</div>
</div>
<p>Shown above is a plot of the mass vs. velocity of the rocket, using the various numerical solving methods (EUler and Heun). These two methods produce the same result. We can compare this result to that of the Tsiolkovsky Equation, which makes the assumption that gravity and drag are significantly smaller than the acceleration and momentum of the propellant. However, this plot makes it clear that in this situation, it is not safe to make this assumption. Based on the specifications of the rocket, it is clear that drag and gravity have a significant impact on the flight of the rocket. For example, the velocity of the rocket at a mass of 0.05kg when gravity and drag are taken into account is roughly half of the velocity when these factors are ignored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Simple Rocket (Euler)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_sold</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">num_sold</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag &amp; Grav. (Euler)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass (kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3.</strong> Solve for the mass change rate that results in detonation at a height of 300 meters. Create a function <code class="docutils literal notranslate"><span class="pre">f_dm</span></code> that returns the final height of the firework when it reaches <span class="math notranslate nohighlight">\(m_{f}=0.05~kg\)</span>. The inputs should be</p>
<p><span class="math notranslate nohighlight">\(f_{m}= f_{m}(\frac{dm}{dt},~parameters)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\frac{dm}{dt}\)</span> is the variable you are using to find a root and <span class="math notranslate nohighlight">\(parameters\)</span> are the known values, <code class="docutils literal notranslate"><span class="pre">m0=0.25,</span> <span class="pre">c=0.18e-3,</span> <span class="pre">u=250</span></code>. When <span class="math notranslate nohighlight">\(f_{m}(\frac{dm}{dt}) = 0\)</span>, you have found the correct root.</p>
<p>Plot the height as a function of time and use a star to denote detonation at the correct height with a <code class="docutils literal notranslate"><span class="pre">'*'</span></code>-marker</p>
<p>Approach the solution in two steps, use the incremental search
<a class="reference internal" href="../module_03/04_Getting_to_the_root.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">incsearch</span></code></span></a> with 5-10
sub-intervals <em>limit the number of times you call the
function</em>. Then, use the modified secant method to find the true root of
the function.</p>
<p>a. Use the incremental search to find the two closest mass change rates within the interval <span class="math notranslate nohighlight">\(\frac{dm}{dt}=0.05-0.4~kg/s.\)</span></p>
<p>b. Use the modified secant method to find the root of the function <span class="math notranslate nohighlight">\(f_{m}\)</span>.</p>
<p>c. Plot your solution for the height as a function of time and indicate the detonation with a <code class="docutils literal notranslate"><span class="pre">*</span></code>-marker.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_dm</span><span class="p">(</span><span class="n">dmdt</span><span class="p">,</span> <span class="n">m0</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.18e-3</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">250</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; define a function f_dm(dmdt) that returns </span>
<span class="sd">    height_desired-height_predicted[-1]</span>
<span class="sd">    here, the time span is based upon the value of dmdt</span>
<span class="sd">    </span>
<span class="sd">    arguments:</span>
<span class="sd">    ---------</span>
<span class="sd">    dmdt: the unknown mass change rate</span>
<span class="sd">    m0: the known initial mass</span>
<span class="sd">    c: the known drag in kg/m</span>
<span class="sd">    u: the known speed of the propellent</span>
<span class="sd">    </span>
<span class="sd">    returns:</span>
<span class="sd">    --------</span>
<span class="sd">    error: the difference between height_desired and height_predicted[-1]</span>
<span class="sd">        when f_dm(dmdt) = 0, the correct mass change rate was chosen</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="n">tmin</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mf</span><span class="o">-</span><span class="n">m0</span><span class="p">)</span><span class="o">/</span><span class="n">dmdt</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">rocket</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">dmdt</span><span class="o">=</span><span class="n">dmdt</span><span class="p">),</span> <span class="p">[</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">m0</span><span class="p">])</span>
    <span class="n">maxheight</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">maxheight</span> <span class="o">-</span> <span class="mi">300</span>
    <span class="k">return</span> <span class="n">error</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">incsearch</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ns</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;incsearch: incremental search root locator</span>
<span class="sd">    xb = incsearch(func,xmin,xmax,ns):</span>
<span class="sd">      finds brackets of x that contain sign changes</span>
<span class="sd">      of a function on an interval</span>
<span class="sd">    arguments:</span>
<span class="sd">    ---------</span>
<span class="sd">    func = name of function</span>
<span class="sd">    xmin, xmax = endpoints of interval</span>
<span class="sd">    ns = number of subintervals (default = 50)</span>
<span class="sd">    returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    xb(k,1) is the lower bound of the kth sign change</span>
<span class="sd">    xb(k,2) is the upper bound of the kth sign change</span>
<span class="sd">    If no brackets found, xb = [].&#39;&#39;&#39;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ns</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">func</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="n">sign_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">delta_sign_f</span> <span class="o">=</span> <span class="n">sign_f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">sign_f</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">i_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">delta_sign_f</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i_zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">([[</span> <span class="n">x</span><span class="p">[</span><span class="n">i_zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]],[</span><span class="n">x</span><span class="p">[</span><span class="n">i_zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">]]</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">nb</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no brackets found</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;check interval or increase ns</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of brackets:  </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">xb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">f_dm_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f_dm</span><span class="p">(</span><span class="n">dmi</span><span class="p">)</span> <span class="k">for</span> <span class="n">dmi</span> <span class="ow">in</span> <span class="n">dm</span><span class="p">])</span>
<span class="n">xa_dm</span> <span class="o">=</span> <span class="n">incsearch</span><span class="p">(</span><span class="n">f_dm</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">f_dm_ar</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa_dm</span><span class="p">,</span> <span class="p">[</span><span class="n">f_dm</span><span class="p">(</span><span class="n">xa_dmi</span><span class="p">)</span><span class="o">+</span><span class="mi">300</span> <span class="k">for</span> <span class="n">xa_dmi</span> <span class="ow">in</span> <span class="n">xa_dm</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass rate (kg/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rocket Trajectory with Drag + Grav&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Above is the plot of mass rate vs. detonation height. In order to limit the number of times the function is called, as well as make the plot easier for viewing, the process is repeated with a smaller interval of mass rates, from 0.05 to 0.1 kg/s. This plot is shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">f_dm_ar2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f_dm</span><span class="p">(</span><span class="n">dmi</span><span class="p">)</span> <span class="k">for</span> <span class="n">dmi</span> <span class="ow">in</span> <span class="n">dm2</span><span class="p">])</span>
<span class="n">xa_dm2</span> <span class="o">=</span> <span class="n">incsearch</span><span class="p">(</span><span class="n">f_dm</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dm2</span><span class="p">,</span> <span class="n">f_dm_ar2</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa_dm2</span><span class="p">,</span> <span class="p">[</span><span class="n">f_dm</span><span class="p">(</span><span class="n">xa_dmi</span><span class="p">)</span><span class="o">+</span><span class="mi">300</span> <span class="k">for</span> <span class="n">xa_dmi</span> <span class="ow">in</span> <span class="n">xa_dm2</span><span class="p">],</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass rate (kg/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rocket Trajectory with Drag + Grav&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mod_secant</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">es</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span><span class="n">maxit</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;mod_secant: Modified secant root location zeroes</span>
<span class="sd">    root,[fx,ea,iter]=mod_secant(func,dfunc,xr,es,maxit,p1,p2,...):</span>
<span class="sd">    uses modified secant method to find the root of func</span>
<span class="sd">    arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">    func = name of function</span>
<span class="sd">    dx = perturbation fraction</span>
<span class="sd">    xr = initial guess</span>
<span class="sd">    es = desired relative error (default = 0.0001 )</span>
<span class="sd">    maxit = maximum allowable iterations (default = 50)</span>
<span class="sd">    p1,p2,... = additional parameters used by function</span>
<span class="sd">    returns:</span>
<span class="sd">    --------</span>
<span class="sd">    root = real root</span>
<span class="sd">    fx = func evaluated at root</span>
<span class="sd">    ea = approximate relative error ( )</span>
<span class="sd">    iter = number of iterations&#39;&#39;&#39;</span>

    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">xr</span><span class="o">=</span><span class="n">x0</span>
    <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxit</span><span class="p">):</span>
        <span class="n">xrold</span> <span class="o">=</span> <span class="n">xr</span><span class="p">;</span>
        <span class="n">dfunc</span><span class="o">=</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">xr</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">-</span><span class="n">func</span><span class="p">(</span><span class="n">xr</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span><span class="o">/</span><span class="n">dfunc</span><span class="p">;</span>
        <span class="k">if</span> <span class="n">xr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ea</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xrold</span><span class="p">)</span><span class="o">/</span><span class="n">xr</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ea</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">xr</span> <span class="o">-</span> <span class="n">xrold</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
        <span class="k">if</span> <span class="n">ea</span> <span class="o">&lt;=</span> <span class="n">es</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">xr</span><span class="p">,[</span><span class="n">func</span><span class="p">(</span><span class="n">xr</span><span class="p">),</span><span class="n">ea</span><span class="p">,</span><span class="nb">iter</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correct_dm</span> <span class="o">=</span> <span class="n">mod_secant</span><span class="p">(</span><span class="n">f_dm</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The correct mass rate is </span><span class="si">{:.8f}</span><span class="s1"> kg/s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">correct_dm</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dm2</span><span class="p">,</span><span class="n">f_dm_ar2</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">correct_dm</span><span class="p">,</span><span class="n">f_dm</span><span class="p">(</span><span class="n">correct_dm</span><span class="p">)</span><span class="o">+</span><span class="mi">300</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mass rate (kg/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rocket Trajectory with Drag + Grav&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">correct_dm</span>
<span class="n">m0</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">mf</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rocket</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">dmdt</span><span class="o">=</span><span class="n">dm</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mf">0.18e-3</span><span class="p">):</span>
    <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span>
    <span class="n">dstate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">/</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">dmdt</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">dstate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dmdt</span>
    <span class="k">return</span> <span class="n">dstate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">m0</span><span class="o">-</span><span class="n">mf</span><span class="p">)</span><span class="o">/</span><span class="n">dm</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_solh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">num_solh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">num_solh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">heun_step</span><span class="p">(</span><span class="n">num_solh</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rocket</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">num_solh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Rocket w/ Drag (Heun)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_solh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Explosion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Math 24 <em>Rocket Motion</em>. <a class="reference external" href="https://www.math24.net/rocket-motion/%5C">https://www.math24.net/rocket-motion/%5C</a></p></li>
<li><p>Kasdin and Paley. <em>Engineering Dynamics</em>. <a class="reference external" href="https://www.jstor.org/stable/j.ctvcm4ggj.9">ch 6-Linear Momentum of a Multiparticle System pp234-235</a> Princeton University Press</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Specific_impulse">https://en.wikipedia.org/wiki/Specific_impulse</a></p></li>
<li><p><a class="reference external" href="https://www.apogeerockets.com/Rocket_Motors/Estes_Motors/13mm_Motors/Estes_13mm_1_4A3-3T">https://www.apogeerockets.com/Rocket_Motors/Estes_Motors/13mm_Motors/Estes_13mm_1_4A3-3T</a></p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../module_03/04_Getting_to_the_root.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Roots of Nonlinear functions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../module_04/README.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Computational Mechanics 4 - Linear Algebra</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Ryan C. Cooper<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>