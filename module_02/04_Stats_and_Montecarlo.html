
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>04 - Statistics and Monte-Carlo Models &#8212; Computational Mechanics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Project #02 - NYSE random walk predictor" href="../projects/02_Analyze-data_project.html" />
    <link rel="prev" title="03 - Linear regression with real data" href="03_Linear_Regression_with_Real_Data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/comp-mech-logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Computational Mechanics
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus - Computational Mechanics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../how-to/update-github.html">
   Working in your  Fork on GitHub.com
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_01/README.html">
   Computational Mechanics 01 - Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/01_Interacting_with_Python.html">
     01 - Interacting with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/02_Working_with_Python.html">
     02 - Working with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_01/03_Numerical_error.html">
     03 - Numerical Error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/01_Getting-started-project.html">
     Computational Mechanics Project #01 - Heat Transfer in Forensic Science
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Computational Mechanics 02 - Analyze Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_Cheers_Stats_Beers.html">
     01 - Cheers!  Stats with Beers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_Seeing_Stats.html">
     02 - Seeing stats in a new light
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_Linear_Regression_with_Real_Data.html">
     03 - Linear regression with real data
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     04 - Statistics and Monte-Carlo Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/02_Analyze-data_project.html">
     Project #02 - NYSE random walk predictor
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_03/README.html">
   Computational Mechanics 03- Initial Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/01_Catch_Motion.html">
     Catch things in motion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/02_Step_Future.html">
     Step to the future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/03_Get_Oscillations.html">
     Get with the oscillations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_03/04_Getting_to_the_root.html">
     Roots of Nonlinear functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/03_IVP-project.html">
     Initial Value Problems - Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_04/README.html">
   Computational Mechanics 4 - Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/01_Linear-Algebra.html">
     Linear Algebra Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/02_Gauss_elimination.html">
     Gauss Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_04/03_Linear-regression-algebra.html">
     Linear Regression Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/04_Linear_Algebra-project.html">
     CompMech04-Linear Algebra Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module_05/README.html">
   Computational Mechanics 5 - Boundary Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/01_Revisiting_derivatives.html">
     Revisiting Derivatives
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/02_Keep_it_steady.html">
     Keep it Steady
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module_05/03_Good_Vibrations.html">
     Good Vibrations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/05-BVPs_project.html">
     Computational Mechanics Boundary Values - Project 05
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../how-to/README.html">
   Quick How-to documents
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/update-github.html">
     Working in your  Fork on GitHub.com
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/polyfit.html">
     Creating a quadratic fit on random data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../how-to/for-loops.html">
     How to use a
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     loop?
     <em>
      in Python
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/extra-FEA_material.html">
     Extra Material: Direct stiffness method for Finite Element analysis (FEA)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/module_02/04_Stats_and_Montecarlo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/module_02/04_Stats_and_Montecarlo.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cooperrc/computational-mechanics"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cooperrc/computational-mechanics/issues/new?title=Issue%20on%20page%20%2Fmodule_02/04_Stats_and_Montecarlo.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cooperrc/computational-mechanics/master?urlpath=tree/module_02/04_Stats_and_Montecarlo.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://compmech.uconn.edu/hub/user-redirect/git-pull?repo=https://github.com/cooperrc/computational-mechanics&urlpath=tree/computational-mechanics/module_02/04_Stats_and_Montecarlo.md&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   04 - Statistics and Monte-Carlo Models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-and-discussion">
     Exercise and Discussion
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples-of-monte-carlo-models">
     Examples of Monte Carlo models:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-calculate-pi-with-random-numbers">
     Example 1: Calculate
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
     with random numbers.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-simulate-brownian-motion-of-particles-in-a-fluid">
     Example 2: Simulate Brownian motion of particles in a fluid
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-discussion">
       Exercise (Discussion)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-your-brownian-motion">
       Generate your Brownian motion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise">
       Exercise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Exercise
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3-determine-uncertainty-in-failure-load-based-on-geometry-uncertainty">
       Example 3: Determine uncertainty in failure load based on geometry uncertainty
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#where-does-a-normal-distribution-come-from">
     Where does a normal distribution come from?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-you-ve-learned">
     What you’ve learned:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <blockquote>
<div><p><strong>Content created under Creative Commons Attribution license CC-BY
4.0, code under BSD 3-Clause License © 2020 R.C. Cooper</strong></p>
</div></blockquote>
<div class="section" id="statistics-and-monte-carlo-models">
<h1>04 - Statistics and Monte-Carlo Models<a class="headerlink" href="#statistics-and-monte-carlo-models" title="Permalink to this headline">¶</a></h1>
<p>Monte Carlo models use random numbers to either understand statistics or generate a solution [1].
The main element in a Monte Carlo model is the use of random numbers. Monte Carlo methods are very useful if you can easily execute a function lots of time or even in parallel.</p>
<p>We can generate random numbers in many ways, but most programming languages have ‘pseudo’-random number generators.</p>
<p>In Python, we use the <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html">NumPy random
library</a> as such</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.25739879, 0.4844079 , 0.61932723, 0.79506491, 0.23599634,
       0.91290898, 0.14879244, 0.91288266, 0.30044943, 0.88013807,
       0.12987376, 0.51673305, 0.98568433, 0.40187176, 0.51595437,
       0.7103972 , 0.12791085, 0.43182025, 0.43273096, 0.06284188])
</pre></div>
</div>
</div>
</div>
<p>NumPy’s random number generator (<code class="docutils literal notranslate"><span class="pre">rng</span></code>) creates random numbers that can
be <a class="reference external" href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">uniformly
distributed</a>,
<a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">normally
distributed</a>, and
<a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#distributions">much
more</a>.
The call to <code class="docutils literal notranslate"><span class="pre">rng.random(20)</span></code> created 20 uniformly random numbers between
0 and 1 saved as the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>. Next, you can plot the histogram of
<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> 
            <span class="n">histtype</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([5., 4., 4., 3., 4.]),
 array([0.06284188, 0.24741037, 0.43197886, 0.61654735, 0.80111584,
        0.98568433]),
 &lt;BarContainer object of 5 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_5_1.png" src="../_images/04_Stats_and_Montecarlo_5_1.png" />
</div>
</div>
<p>The pyplot function <code class="docutils literal notranslate"><span class="pre">hist</span></code> displays a histogram of these randomly generated numbers.</p>
<div class="section" id="exercise-and-discussion">
<h2>Exercise and Discussion<a class="headerlink" href="#exercise-and-discussion" title="Permalink to this headline">¶</a></h2>
<p>Try generating more random numbers and plotting histograms of the results i.e. increase <code class="docutils literal notranslate"><span class="pre">10</span></code> to larger values.</p>
<p>What should the histogram of <code class="docutils literal notranslate"><span class="pre">x</span></code> look like if Python is generating truly random numbers?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_Stats_and_Montecarlo_8_0.png" src="../_images/04_Stats_and_Montecarlo_8_0.png" />
</div>
</div>
</div>
<div class="section" id="examples-of-monte-carlo-models">
<h2>Examples of Monte Carlo models:<a class="headerlink" href="#examples-of-monte-carlo-models" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo models have a wide array of applications. We are going to use Monte Carlo models in later modules to explore how uncertainty in measurements can be incorporated into computational models. The three main applications for Monte Carlo models are used in three main classes: optimization, numerical integration, and generating population distributions [1].</p>
<p>Here is a brief list of Monte Carlo model use cases in real-world applications:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://link.springer.com/chapter/10.1007%2FBFb0049064">Eigenvlaues in supercritical systems</a></p></li>
<li><p><a class="reference external" href="http://www.egr.msu.edu/~mitraj/research/pubs/proc/singh-mitra_em_stdby_ias95.pdf">average time between failures for reliability</a></p></li>
<li><p>disordered materials (physics)</p></li>
<li><p><a class="reference external" href="http://www.mdpi.com/1996-1073/9/4/286/pdf">Calculation of the energy output of a wind farm</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Search_and_Rescue_Optimal_Planning_System">US Coast Guard rescue missions</a></p></li>
<li><p><a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0920379612000580">Radiation shielding</a></p></li>
<li><p><a class="reference external" href="https://cneos.jpl.nasa.gov/sentry/intro.html">Predict number of asteroids that hit body of water</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_methods_in_finance">Financial modeling</a></p></li>
</ul>
<p>We will explore Monte Carlo modeling through the use of three examples:</p>
<ol class="simple">
<li><p>Calculate the value of <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p>Simulate Brownian motion of particles in fluids</p></li>
<li><p>Propagate uncertainty in manufacturing into uncertainty in failure load</p></li>
</ol>
</div>
<div class="section" id="example-1-calculate-pi-with-random-numbers">
<h2>Example 1: Calculate <span class="math notranslate nohighlight">\(\pi\)</span> with random numbers.<a class="headerlink" href="#example-1-calculate-pi-with-random-numbers" title="Permalink to this headline">¶</a></h2>
<p>Assuming we can actually generate random numbers (a topic of philosophical and heated debates) we can populate a unit square with random points and determine the ratio of points inside and outside of a circle.</p>
<p><img alt="Unit circle and unit square" src="../_images/MonteCarloPi.gif" /></p>
<p><img alt="1/4 Unit circle and 1/4 unit square" src="../_images/MonteCarloPi_rand.gif" /></p>
<p>The ratio of the area of the circle to the square is:</p>
<p><span class="math notranslate nohighlight">\(\frac{\pi r^{2}}{4r^{2}}=\frac{\pi}{4}\)</span></p>
<p>So if we know the fraction of random points that are within the unit circle, then we can calculate <span class="math notranslate nohighlight">\(\pi\)</span></p>
<p>(number of points in circle)/(total number of points)=<span class="math notranslate nohighlight">\(\pi/4\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">montecarlopi</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create random x-y-coordinates to and use ratio of circle-to-square to </span>
<span class="sd">    calculate the value of pi</span>
<span class="sd">    i.e. Acircle/Asquare = pi/4</span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    N: number of random points to produce between x=0-1 and y=0-1</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    our_pi: the best prediction of pi using N points</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
    <span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span> <span class="c1"># compute radius</span>
    <span class="n">num_in_circle</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">R</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">total_num_pts</span> <span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">);</span>
    <span class="n">our_pi</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">num_in_circle</span><span class="o">/</span><span class="n">total_num_pts</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">our_pi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_pi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">test_pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">montecarlopi</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean value for pi = </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.mean(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;standard deviation is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.std(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actual pi is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.pi)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean value for pi = 3.136720
standard deviation is 0.015253
actual pi is 3.141593
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Why is there a standard deviation for the value of <span class="math notranslate nohighlight">\(\pi\)</span> calculated with a Monte Carlo method? Does it depend upon how many times you run the function i.e. the size of <code class="docutils literal notranslate"><span class="pre">test_pi</span></code>? or the number of random points <code class="docutils literal notranslate"><span class="pre">N</span></code>? Alter the script above to discover correlations</p></li>
<li><p>How well does your function <code class="docutils literal notranslate"><span class="pre">montecarlopi</span></code> converge to the true value
of <span class="math notranslate nohighlight">\(\pi\)</span> (you can use <code class="docutils literal notranslate"><span class="pre">np.pi</span></code> as a true value)? Plot the convergence as
we did in <span class="xref myst">03-Numerical_error</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_pi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">test_pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">montecarlopi</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean value for pi = </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.mean(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;standard deviation is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.std(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actual pi is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.pi)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean value for pi = 3.139760
standard deviation is 0.053159
actual pi is 3.141593
</pre></div>
</div>
</div>
</div>
<p>Compare the above 100 <code class="docutils literal notranslate"><span class="pre">test_pi</span></code> cases each 1000 points.</p>
<p>to the below 10 <code class="docutils literal notranslate"><span class="pre">test_pi</span></code> cases each 10,000 points.</p>
<p>Above, the std is the same as before <span class="math notranslate nohighlight">\(\approx 0.05\)</span></p>
<p>Below, the std is decreased to <span class="math notranslate nohighlight">\(\approx 0.01\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_pi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">test_pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">montecarlopi</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean value for pi = </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.mean(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;standard deviation is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.std(test_pi))
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actual pi is </span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.pi)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean value for pi = 3.138720
standard deviation is 0.019195
actual pi is 3.141593
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
    <span class="n">mypi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">mypi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">montecarlopi</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
    <span class="n">mupi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mypi</span><span class="p">)</span>
    <span class="n">error</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">mupi</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;N=10^n&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;relative error&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_Stats_and_Montecarlo_16_0.png" src="../_images/04_Stats_and_Montecarlo_16_0.png" />
</div>
</div>
</div>
<div class="section" id="example-2-simulate-brownian-motion-of-particles-in-a-fluid">
<h2>Example 2: Simulate Brownian motion of particles in a fluid<a class="headerlink" href="#example-2-simulate-brownian-motion-of-particles-in-a-fluid" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.britannica.com/science/Brownian-motion">Brownian motion</a>
was first documented by Robert Brown, a Scottish botanist in 1827. It is
a description of how large particles move and vibrate in fluids that
have no buld motion. The atoms from the fluid bounce off the suspended
particles to jiggle them randomly left and right. Take a look at <a class="reference external" href="https://www.youtube.com/channel/UCSIvk78tK2TiviLQn4fSHaw">Up and
Atom’s video</a>
for more information in the physics and history of the phenomenon.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;5jBVYvHeG2c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="400"
    height="300"
    src="https://www.youtube.com/embed/5jBVYvHeG2c"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
<p>In this example, your goal is to predict the location of 50 particles
if they take 100 random steps from -0.5 to 0.5 <span class="math notranslate nohighlight">\(\mu m\)</span> in the x- and
y-directions.</p>
<div class="section" id="exercise-discussion">
<h3>Exercise (Discussion)<a class="headerlink" href="#exercise-discussion" title="Permalink to this headline">¶</a></h3>
<p>If the steps are uniformly random and can be positive or negative, where
do you <em>expect</em> the particle to be after 100 steps? Will it be back to
where it started? or will it migrate to somewhere new?</p>
</div>
<div class="section" id="generate-your-brownian-motion">
<h3>Generate your Brownian motion<a class="headerlink" href="#generate-your-brownian-motion" title="Permalink to this headline">¶</a></h3>
<p>Here, we are simplifying the physics of the Brownian motion (ignoring
the details in the transfer of momentum from small to large particles)
and just assuming each step in the x- and y-directions are  -0.5 to 0.5
<span class="math notranslate nohighlight">\(\mu m\)</span>. Here is the Monte Carlo process:</p>
<ol class="simple">
<li><p>generate 2 sets of 100 random numbers between -0.5 to 0.5 for
<span class="math notranslate nohighlight">\(Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta y\)</span>.</p></li>
<li><p>create an array with 100 locations, the first is at the origin (0, 0)</p></li>
<li><p>take a cumulative sum of the <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta y\)</span> steps to find
the location at each step</p></li>
<li><p>plot the results</p></li>
</ol>
<p>Here, you create the 100 random numbers and shift them by 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
<span class="n">N_steps</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
<p>Next, create the positions at each step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_steps</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now, use
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.cumsum.html"><code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code></a>
to find the final position after each step is taken.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="c1"># final rx position</span>
<span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="c1"># final ry position</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, you can plot the path the particle took as it moved along its
100 steps and its final location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span> <span class="p">],</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-position (um)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y-position (um)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y-position (um)&#39;)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_26_1.png" src="../_images/04_Stats_and_Montecarlo_26_1.png" />
</div>
</div>
<p>A curious result, even though we prescribed random motion, the final
location did not end up back at the origin, where it started. <strong>What if
you looked at 50 particles?</strong> How many would end up back at the origin?
Use a for-loop to calculate the position of 50 particles taking 100
steps each.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_particles</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">r_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_particles</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_steps</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
    <span class="n">r_final</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span> <span class="p">],</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_final</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r_final</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7efd5058d460&gt;]
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_28_1.png" src="../_images/04_Stats_and_Montecarlo_28_1.png" />
</div>
</div>
</div>
<div class="section" id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<p>Calculate the average location of the particles. What is the standard
deviation?</p>
</div>
</div>
<div class="section" id="id1">
<h2>Exercise<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Compare the scaled histogram to the original histogram. What is similar? What is different?</p>
<p>Make a scaling equation to get uniformly random numbers between 10 and 20.</p>
<p><em>The scaling keeps the bin heights constant, but it changes the width and location of the bins in the histogram. Scaling to 10-20 shows a more extreme example.</em></p>
<div class="section" id="example-3-determine-uncertainty-in-failure-load-based-on-geometry-uncertainty">
<h3>Example 3: Determine uncertainty in failure load based on geometry uncertainty<a class="headerlink" href="#example-3-determine-uncertainty-in-failure-load-based-on-geometry-uncertainty" title="Permalink to this headline">¶</a></h3>
<p>In this example, we know that a steel bar will break under 940 MPa tensile stress. The bar is 1 mm by 2 mm with a tolerance of 10 %. What is the range of tensile loads that can be safely applied to the beam?</p>
<p><span class="math notranslate nohighlight">\(\sigma_{UTS}=\frac{F_{fail}}{wh}\)</span></p>
<p><span class="math notranslate nohighlight">\(F_{fail}=\sigma_{UTS}wh\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">wmean</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># in mm</span>
<span class="n">wmin</span> <span class="o">=</span> <span class="n">wmean</span><span class="o">-</span><span class="n">wmean</span><span class="o">*</span><span class="mf">0.1</span>
<span class="n">wmax</span> <span class="o">=</span> <span class="n">wmean</span><span class="o">+</span><span class="n">wmean</span><span class="o">*</span><span class="mf">0.1</span>
<span class="n">hmean</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># in mm</span>
<span class="n">hmin</span> <span class="o">=</span> <span class="n">hmean</span><span class="o">-</span><span class="n">hmean</span><span class="o">*</span><span class="mf">0.1</span>
<span class="n">hmax</span> <span class="o">=</span> <span class="n">hmean</span><span class="o">+</span><span class="n">hmean</span><span class="o">*</span><span class="mf">0.1</span>

<span class="n">wrand</span><span class="o">=</span><span class="n">wmin</span><span class="o">+</span><span class="p">(</span><span class="n">wmax</span><span class="o">-</span><span class="n">wmin</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>
<span class="n">hrand</span><span class="o">=</span><span class="n">hmin</span><span class="o">+</span><span class="p">(</span><span class="n">hmax</span><span class="o">-</span><span class="n">hmin</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>

<span class="n">uts</span><span class="o">=</span><span class="mi">940</span> <span class="c1"># in N/mm^2=MPa</span>

<span class="n">Ffail</span><span class="o">=</span><span class="n">uts</span><span class="o">*</span><span class="n">wrand</span><span class="o">*</span><span class="n">hrand</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># force in kN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">Ffail</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;failure load (kN)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;relative counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Failure load is </span><span class="si">{:.2f}</span><span class="s1">+/- </span><span class="si">{:.2f}</span><span class="s1"> kN&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ffail</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Ffail</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Failure load is 1.88+/- 0.22 kN&#39;)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_34_1.png" src="../_images/04_Stats_and_Montecarlo_34_1.png" />
</div>
</div>
<p>Normally, the tolerance is not a maximum/minimum specification, but
instead a normal distribution that describes the standard deviation, or
the 68% confidence interval.</p>
<p>So instead, you should generate normally distributed dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">wmean</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># in mm</span>
<span class="n">wstd</span><span class="o">=</span><span class="n">wmean</span><span class="o">*</span><span class="mf">0.1</span> <span class="c1"># standard deviation in mm</span>
<span class="n">hmean</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># in mm</span>
<span class="n">hstd</span><span class="o">=</span><span class="n">hmean</span><span class="o">*</span><span class="mf">0.1</span> <span class="c1"># standard deviation in mm</span>


<span class="n">wrand</span><span class="o">=</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">wmean</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">wstd</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">hrand</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">hmean</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">hstd</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">uts</span><span class="o">=</span><span class="mi">940</span> <span class="c1"># in N/mm^2=MPa</span>

<span class="n">Ffail</span><span class="o">=</span><span class="n">uts</span><span class="o">*</span><span class="n">wrand</span><span class="o">*</span><span class="n">hrand</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># force in kN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">Ffail</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.xlabel(&#39;failure load (kN)&#39;)</span>
<span class="c1">#plt.ylabel(&#39;relative counts&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Failure load is </span><span class="si">{:.2f}</span><span class="s1">+/- </span><span class="si">{:.2f}</span><span class="s1"> kN&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ffail</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Ffail</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Failure load is 1.88+/- 0.27 kN&#39;)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_36_1.png" src="../_images/04_Stats_and_Montecarlo_36_1.png" />
</div>
</div>
<p>In this propagation of uncertainty, the final value of failure load seems to be independent of wheher the distribution is uniformly random or normally distributed. In both cases, the failure load is <span class="math notranslate nohighlight">\(\approx 1.9 \pm 0.25\)</span> kN.</p>
<p>The difference is much more apparent if you look at the number of occurrences that failure will occur whether the dimensions are uniformly random or normally distributed.</p>
<p>For the uniformly random case, there are approximately 500 parts out of 10,000 that will fail at 1.9 kN.</p>
<p>For the normally distributed case, there are approximately 1500 parts out of 10,000 that will fail at 1.9 kN.</p>
</div>
</div>
<div class="section" id="where-does-a-normal-distribution-come-from">
<h2>Where does a normal distribution come from?<a class="headerlink" href="#where-does-a-normal-distribution-come-from" title="Permalink to this headline">¶</a></h2>
<p>“Everybody believes in the exponential law of errors: the experimenters, because they think it can be proved by mathematics; and the mathematicians, because they believe it has been established by observation” [5].</p>
<p>In the previous example, we drew dimensions from uniformly random distributions and normally distributed random distributions. Why do we use the “normal” distribution to describe data with a mean and standard deviation? There are exact statistical methods to derive the normal distribution, but let’s take a look at a Monte Carlo approach.</p>
<p>Let’s say there are 10 different independent factors that could change the dimensions of the steel bar in question e.g. which tool was used, how old the blade is, the humidity, the temperature, and the list goes on.</p>
<p>Let’s consider one dimension.
Each of these factors could change the dimensions of the part, let’s use a uniform scale of -1/2-1/2.
If the effect is 0, the dimension is exactly as specified. If the effect is -1/2, the dimension is much smaller. Conversely, if the effect is 1/2 the dimension is much larger. Now, we use a Monte Carlo model to generate 10 effects on 10,000 parts as shown in the next block.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># each row represents a part and each column is an effect (-1/2-1/2)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we have created 10,000 parts with 10 uniformly random effects between -1/2-1/2.</p>
<p>We sum the effects and look at the final part distribution. The x-axis is labeled “A.U.” for arbitrary units, we are just assuming an effect of -1/2-1/2 for each of the 10 factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;effect A.U.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;number of parts&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;number of parts&#39;)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_40_1.png" src="../_images/04_Stats_and_Montecarlo_40_1.png" />
</div>
</div>
<p>Now, depending upon which random numbers were generated, you should see what looks like a normal distribution.</p>
<p>Normal distributions come from the assumption that we have a large (or infinite) number of uncontrollable factors that can change our desired result. In our case, ideally each factor would have an effect of 0, because then it is exactly as specified, but the reality is that we can’t control most factors. As engineers, we always have to consider the uncertainty in our models and measurements.</p>
</div>
<div class="section" id="what-you-ve-learned">
<h2>What you’ve learned:<a class="headerlink" href="#what-you-ve-learned" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How to generate “random” numbers in Python<span class="math notranslate nohighlight">\(^+\)</span></p></li>
<li><p>The definition of a Monte Carlo model</p></li>
<li><p>How to calculate <span class="math notranslate nohighlight">\(\pi\)</span> with Monte Carlo</p></li>
<li><p>How to model Brownian motion with Monte Carlo</p></li>
<li><p>How to propagate uncertainty in a model with Monte Carlo</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(^+\)</span> Remember, the computer only generates pseudo-random numbers. For further information <strong>and</strong> truly random numbers  check <a class="reference external" href="https://www.random.org/randomness/">www.random.org</a></p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wics.1314">Why the Monte Carlo method is so important today
Dirk P. Kroese, Tim Brereton <em>et al.</em> Wiley Interdisciplinary Reviews: Computational Statistics, 6, 6, 11 2014</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_integration">Wikipedia: Monte Carlo integration</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/hep-ph/0006269">Weinzierl, S. (2000). “Introduction to Monte Carlo methods”</a></p></li>
<li><p>Meurer A, <em>et al.</em> (2017) SymPy: symbolic computing in Python. PeerJ Computer Science 3:e103 https://doi.org/10.7717/peerj-cs.103</p></li>
<li><p>Whittaker, E. T. and Robinson, G. “Normal Frequency Distribution.” Ch. 8 in The Calculus of Observations: A Treatise on Numerical Mathematics, 4th ed. New York: Dover, p. 179, 1967.</p></li>
</ol>
</div>
</div>
<div class="section" id="problems">
<h1>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h1>
<p><strong>1.</strong> <a class="reference external" href="https://en.wikipedia.org/wiki/Buffon">Buffon’s needle problem</a> is
another way to estimate the value of <span class="math notranslate nohighlight">\(\pi\)</span> with random numbers. The goal
in this Monte Carlo estimate of <span class="math notranslate nohighlight">\(\pi\)</span> is to create a ratio that is close
to <a class="reference external" href="http://www.math.com/tables/constants/pi.htm">3.1415926…</a> <em>similar
to the example with darts points lying inside/outside a unit circle
inside a unit square.</em></p>
<p><img alt="Buffon's needle for parallellines" src="https://upload.wikimedia.org/wikipedia/commons/f/f6/Buffon_needle.gif" /></p>
<p>In this Monte Carlo estimation, you only need to know two values:</p>
<ul class="simple">
<li><p>the distance from line 0, <span class="math notranslate nohighlight">\(x = [0,~1]\)</span></p></li>
<li><p>the orientation of the needle, <span class="math notranslate nohighlight">\(\theta = [0,~2\pi]\)</span></p></li>
</ul>
<p>The y-location does not affect the outcome of crosses line 0 or not
crossing line 0.</p>
<p><strong>a.</strong> Generate 100 random <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">theta</span></code> values <em>remember</em> <span class="math notranslate nohighlight">\(\theta =
[0,~2\pi]\)</span></p>
<p><strong>b.</strong> Calculate the x locations of the 100 needle ends e.g. <span class="math notranslate nohighlight">\(x_end = x
\pm \cos\theta\)</span> _since length is unit 1.</p>
<p><strong>c.</strong> Use
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.logical_and.html"><code class="docutils literal notranslate"><span class="pre">np.logical_and</span></code></a>
to find the number of needles that have minimum <span class="math notranslate nohighlight">\(x_{end~min}&lt;0\)</span> and
maximum <span class="math notranslate nohighlight">\(x_{end~max}&gt;0\)</span>. The ratio
<span class="math notranslate nohighlight">\(\frac{x_{end~min}&lt;0~and~x_{end~max}&gt;0}{number~of~needles} =
\frac{2}{\pi}\)</span> <em>for large values of <span class="math notranslate nohighlight">\(number~of~needles\)</span></em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">x_min</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">pi_appr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">x_min</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My estimated value using Buffon</span><span class="se">\&#39;</span><span class="s1">s needle problem is:&#39;</span><span class="p">,</span> <span class="n">pi_appr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>My estimated value using Buffon&#39;s needle problem is: 3.1250976593018533
</pre></div>
</div>
</div>
</div>
<p><strong>2.</strong> Build a random walk data set with steps between <span class="math notranslate nohighlight">\(dx = dy =
-1/2~to~1/2~m\)</span>. If 100 particles take 10 steps, calculate the number of
particles that move further than 0.5 m.</p>
<p><em>Bonus: Can you do the work without any <code class="docutils literal notranslate"><span class="pre">for</span></code>-loops? Change the size of
<code class="docutils literal notranslate"><span class="pre">dx</span></code> and <code class="docutils literal notranslate"><span class="pre">dy</span></code> to account for multiple particles.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
<span class="n">N_steps</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">num_particles</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">r_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_particles</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N_steps</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_steps</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
    <span class="n">r_final</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span> <span class="p">],</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_final</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r_final</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1">#count number of particles that moved to a final point outside a radius of 0.5m from the origin</span>
<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_final</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">r_final</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of particles that moved to a final pont outside of a radius of 0.5m from the origin is:&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of particles that moved to a final pont outside of a radius of 0.5m from the origin is: 85
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_45_1.png" src="../_images/04_Stats_and_Montecarlo_45_1.png" />
</div>
</div>
<p><strong>3.</strong> 100 steel rods are going to be used to support a 1000 kg structure. The
rods will buckle when the load in any rod exceeds the <a class="reference external" href="https://en.wikipedia.org/wiki/Euler%27s_critical_load">critical buckling
load</a></p>
<p><span class="math notranslate nohighlight">\(P_{cr}=\frac{\pi^3 Er^4}{16L^2}\)</span></p>
<p>where E=200e9 Pa, r=0.01 m +/-0.001 m, and L is the
length of the rods supporting the structure. Create a Monte
Carlo model <code class="docutils literal notranslate"><span class="pre">montecarlo_buckle</span></code> that predicts
the mean and standard deviation of the buckling load for 100
samples with normally distributed dimensions r and L.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean_buckle_load</span><span class="p">,</span><span class="n">std_buckle_load</span><span class="o">=</span>\
<span class="n">montecarlo_buckle</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">r_mean</span><span class="p">,</span><span class="n">r_std</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>a.</strong> What is the mean_buckle_load and std_buckle_load for L=5 m?</p>
<p><strong>b.</strong> What length, L, should the beams be so that only 2.5% will
reach the critical buckling load?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">montecarlo_buckle</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">r_mean</span><span class="p">,</span><span class="n">r_std</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Generate N rods of length L with radii of r=r_mean+/-r_std</span>
<span class="sd">    then calculate the mean and std of the buckling loads in for the</span>
<span class="sd">    rod population holding a 1000-kg structure</span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    E: Young&#39;s modulus [note: keep units consistent]</span>
<span class="sd">    r_mean: mean radius of the N rods holding the structure</span>
<span class="sd">    r_std: standard deviation of the N rods holding the structure</span>
<span class="sd">    L: length of the rods (or the height of the structure)</span>
<span class="sd">    N: number of rods holding the structure, default is N=100 rods</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mean_buckle_load: mean buckling load of N rods under 1000*9.81/N-Newton load</span>
<span class="sd">    std_buckle_load: std dev buckling load of N rods under 1000*9.81/N-Newton load</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">r_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">r_mean</span><span class="p">,</span> <span class="n">r_std</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_rand</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    
    <span class="n">mean_buckle_load</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">std_buckle_load</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">,</span> <span class="n">p</span>

<span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">,</span> <span class="n">p_dist</span> <span class="o">=</span> <span class="n">montecarlo_buckle</span><span class="p">(</span><span class="mf">200e9</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;For a rod of length L = 5 meters, &#39;</span>
      <span class="s1">&#39;the mean buckle load is </span><span class="si">{:.2f}</span><span class="s1"> N and the standard deviation of the buckle load is </span><span class="si">{:.2f}</span><span class="s1"> N&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="nb">print</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">p_dist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Buckle Load (in N)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For a rod of length L = 5 meters, the mean buckle load is 165.72 N and the standard deviation of the buckle load is 74.26 N
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>311.2735342203425
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_47_2.png" src="../_images/04_Stats_and_Montecarlo_47_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#we&#39;ve found that the critical length producing only 2.5% rod buckles is between 0.5 and 1, scan that range for more precise values</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">crit_thres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)):</span>
    <span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">,</span> <span class="n">p_dist</span> <span class="o">=</span> <span class="n">montecarlo_buckle</span><span class="p">(</span><span class="mf">200e9</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">crit_thres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">mean_buckle_load</span><span class="p">,</span> <span class="n">std_buckle_load</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">crit_thres</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;97.5 percentile buckle load</span><span class="se">\n</span><span class="s1">find L at load = 9810&#39;</span><span class="p">);</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">crit_thres</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">9800</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">9820</span><span class="p">:</span>
        <span class="n">crit</span> <span class="o">=</span> <span class="n">t</span>

<span class="n">crit_length</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">crit_thres</span> <span class="o">==</span> <span class="n">crit</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">crit_length</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9807.221079683242 [0.92021011]
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_49_1.png" src="../_images/04_Stats_and_Montecarlo_49_1.png" />
</div>
</div>
<p>What length, L, should the beams be so that only 2.5% will reach the critical buckling load?</p>
<p>From this question, we need to find the length L such that 2.5% of the rods have a buckling load larger than 1000 * 9.81 = 9810 Newtons</p>
<p>Since this is a monte carlo simulation, it varies slightly between runs, but we found that a rod length of roughly 0.91 meters is adequate enough so that only 2.5% of the rods will buckle under the given load.</p>
<p><strong>4.</strong> Generate your own normal distribution using uniformly random numbers between -1/2 and 1/2.</p>
<p><strong>a.</strong> What is the effect of changing the number of factors?</p>
<p><strong>b.</strong> What is the effect of changing the number of samples?</p>
<p><em>Hint: for a-b try plotting histograms of the results.</em></p>
<p><strong>c.</strong> How would you change the mean in your generated distribution?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(3.a) and (3.b)&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">normdist</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span><span class="n">effects</span><span class="p">):</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span><span class="n">effects</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dims</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normdist</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Low Effects&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normdist</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;High Effects&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normdist</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Low Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normdist</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;High Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3.a) and (3.b)
</pre></div>
</div>
<img alt="../_images/04_Stats_and_Montecarlo_52_1.png" src="../_images/04_Stats_and_Montecarlo_52_1.png" />
<img alt="../_images/04_Stats_and_Montecarlo_52_2.png" src="../_images/04_Stats_and_Montecarlo_52_2.png" />
<img alt="../_images/04_Stats_and_Montecarlo_52_3.png" src="../_images/04_Stats_and_Montecarlo_52_3.png" />
<img alt="../_images/04_Stats_and_Montecarlo_52_4.png" src="../_images/04_Stats_and_Montecarlo_52_4.png" />
</div>
</div>
<p>(3.a) As the number effects increases, the total range of the distribution increases since there are more contributing factors.
When more effects are added, the distribution gets slightly steeper, with a higher percentage of values centered closer to the mean. Regardless, with sufficient samples, the distribution maintains the bell-curve shape.</p>
<p>(3.b) As the number of samples increases, the shape of the distribution approaches a smoother bell curve. When there are too few samples, the distribution appears choppy, signifying the lack of sufficient samples.</p>
<p>(3.c) The model is currently set up to produce random values between 0 and 1, following a normal distribution centered around 0.5. These values are then shifted downwards -0.5, to produce a normal distribution with a mean of 0, ranging from -0.5 to 0.5. The mean could be changed by altering the size of the shift -&gt; for example, changing the shift to + 9.5 would produce a distribution with a mean around 10.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./module_02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="03_Linear_Regression_with_Real_Data.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">03 - Linear regression with real data</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../projects/02_Analyze-data_project.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Project #02 - NYSE random walk predictor</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Ryan C. Cooper<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>